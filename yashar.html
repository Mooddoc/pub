<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>משחק ישר המספרים לילדים - צבעי הקשת</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            direction: rtl;
            text-align: center;
            background-color: #f0f0f0;
            margin: 20px;
            background-image: linear-gradient(to right, red, orange, yellow, green, blue, indigo, violet);
            color: white;
        }
        .game-container {
            margin: 0 auto;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            max-width: 800px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .number-line {
            margin: 20px auto;
            width: 90%;
            height: 100px;
            position: relative;
            background-color: #fff;
            border: 2px solid #000;
            border-radius: 10px;
            cursor: pointer;
        }
        .number-line::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background-color: #000;
        }
        .number {
            position: absolute;
            top: 60%;
            transform: translateX(-50%);
            font-weight: bold;
            font-size: 18px;
            color: #333;
        }
        .tick {
            position: absolute;
            width: 2px;
            height: 10px;
            background-color: #000;
            top: 50%;
            transform: translateX(-50%);
        }
        .instructions {
            font-size: 22px;
            margin-bottom: 20px;
            color: #333;
            direction: ltr;
            text-align: center;
        }
        #feedback {
            font-size: 20px;
            margin-top: 20px;
        }
        #next-btn {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 18px;
            background-color: #00796b;
            color: #fff;
            border: none;
            border-radius: 10px;
            cursor: pointer;
        }
        #next-btn.hidden {
            display: none;
        }
        /* Custom cursor with animal emoji */
        .custom-cursor {
            cursor: none;
        }
        .animal-cursor {
            position: absolute;
            pointer-events: none;
            z-index: 1000;
            font-size: 32px;
            transition: transform 0.1s ease;
        }
        /* Confetti */
        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10000;
        }
        /* Farm fence */
        #farm-container {
            margin-top: 20px;
            padding: 10px;
            background-color: #fff;
            border: 2px solid #000;
            border-radius: 10px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            min-height: 100px;
            position: relative;
        }
        #farm-container::before {
            content: 'חווה';
            position: absolute;
            top: -20px;
            background-color: #fff;
            padding: 0 10px;
            font-weight: bold;
        }
        .animal-icon {
            font-size: 32px;
            margin: 5px;
        }
        .special-animal-icon {
            font-size: 64px;
            margin: 5px;
        }
        /* Mini-game styles */
        #minigame-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        #minigame-target {
            font-size: 64px;
            position: absolute;
            animation: moveAnimal 10s ease-in-out infinite;
        }
        #minigame-timer {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 30px;
            color: white;
        }
        @keyframes moveAnimal {
            0% { top: 0; left: 0; transform: translate(0, 0); }
            25% { top: 20%; left: 70%; transform: translate(50px, -50px); }
            50% { top: 70%; left: 50%; transform: translate(-50px, 50px); }
            75% { top: 90%; left: 10%; transform: translate(-50px, -50px); }
            100% { top: 0; left: 0; transform: translate(0, 0); }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>משחק ישר המספרים לילדים - צבעי הקשת</h1>
        <div id="game">
            <div class="instructions" id="question"></div>
            <div class="number-line" id="number-line">
                <!-- Number ticks from 0 to 20 -->
                <div class="tick" style="left: 0%;"></div>
                <div class="number" style="left: 0%;">0</div>
                <div class="tick" style="left: 5%;"></div>
                <div class="number" style="left: 5%;">1</div>
                <div class="tick" style="left: 10%;"></div>
                <div class="number" style="left: 10%;">2</div>
                <div class="tick" style="left: 15%;"></div>
                <div class="number" style="left: 15%;">3</div>
                <div class="tick" style="left: 20%;"></div>
                <div class="number" style="left: 20%;">4</div>
                <div class="tick" style="left: 25%;"></div>
                <div class="number" style="left: 25%;">5</div>
                <div class="tick" style="left: 30%;"></div>
                <div class="number" style="left: 30%;">6</div>
                <div class="tick" style="left: 35%;"></div>
                <div class="number" style="left: 35%;">7</div>
                <div class="tick" style="left: 40%;"></div>
                <div class="number" style="left: 40%;">8</div>
                <div class="tick" style="left: 45%;"></div>
                <div class="number" style="left: 45%;">9</div>
                <div class="tick" style="left: 50%;"></div>
                <div class="number" style="left: 50%;">10</div>
                <div class="tick" style="left: 55%;"></div>
                <div class="number" style="left: 55%;">11</div>
                <div class="tick" style="left: 60%;"></div>
                <div class="number" style="left: 60%;">12</div>
                <div class="tick" style="left: 65%;"></div>
                <div class="number" style="left: 65%;">13</div>
                <div class="tick" style="left: 70%;"></div>
                <div class="number" style="left: 70%;">14</div>
                <div class="tick" style="left: 75%;"></div>
                <div class="number" style="left: 75%;">15</div>
                <div class="tick" style="left: 80%;"></div>
                <div class="number" style="left: 80%;">16</div>
                <div class="tick" style="left: 85%;"></div>
                <div class="number" style="left: 85%;">17</div>
                <div class="tick" style="left: 90%;"></div>
                <div class="number" style="left: 90%;">18</div>
                <div class="tick" style="left: 95%;"></div>
                <div class="number" style="left: 95%;">19</div>
                <div class="tick" style="left: 100%;"></div>
                <div class="number" style="left: 100%;">20</div>
            </div>
            <div id="feedback"></div>
            <button id="next-btn" class="hidden" onclick="nextLevel()">השלב הבא</button>
        </div>
        <div id="animal-cursor" class="animal-cursor"></div>
        <canvas id="confetti-canvas" class="confetti"></canvas>
        <div id="farm-container"></div>
    </div>

    <!-- Mini-game container -->
    <div id="minigame-container">
        <div id="minigame-timer">20</div>
        <div id="minigame-target">🐉</div>
    </div>

    <script>
        // יצירת סדרה של מספרים מ-0 עד 20
        const numbers = Array.from({ length: 21 }, (_, i) => i);

        // ערבוב המספרים כדי לייצר סדרה רנדומלית
        for (let i = numbers.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [numbers[i], numbers[j]] = [numbers[j], numbers[i]];
        }

        // חיות שונות לשימוש בכל שלב
        const animals = [
            "🐘", "🦁", "🐻", "🦒", "🐒", "🐨", "🐼", "🐧", "🦊", "🐦",
            "🐢", "🐍", "🐙", "🐬", "🦉", "🐓", "🐥", "🦄", "🐇", "🐿️",
            "🦅", "🦋", "🐌", "🐝", "🐞", "🦔", "🦡", "🦦", "🦘", "🐪",
            "🦏", "🐫", "🐊", "🦕", "🦖", "🐅", "🐆", "🐘", "🦓", "🐕"
        ];

        // חיות מיוחדות למשחקי הביניים
        const specialAnimals = ["🐉", "🦁", "🦄", "🦢", "🦥", "🦩", "🦚", "🦍"];

        // יצירת שאלות חשבון - חיבור וחיסור בלבד וללא מספרים שליליים
        const simpleMathQuestions = [
            (num) => {
                const addend = Math.floor(Math.random() * (21 - num));
                return { question: `${num} + ${addend} = ?`, answer: num + addend };
            },
            (num) => {
                const subtrahend = Math.floor(Math.random() * (num + 1));
                return { question: `${num} - ${subtrahend} = ?`, answer: num - subtrahend };
            }
        ];

        // יצירת שאלות עם 3 איברים החל משלב 5
        const complexMathQuestions = [
            (num) => {
                const subtrahend1 = Math.floor(Math.random() * (num + 1));
                const addend = Math.floor(Math.random() * (21 - (num - subtrahend1)));
                return { question: `${num} - ${subtrahend1} + ${addend} = ?`, answer: num - subtrahend1 + addend };
            },
            (num) => {
                const addend1 = Math.floor(Math.random() * (21 - num));
                const subtrahend = Math.floor(Math.random() * (num + addend1 + 1));
                return { question: `${num} + ${addend1} - ${subtrahend} = ?`, answer: num + addend1 - subtrahend };
            }
        ];

        // יצירת שאלות עם 4 איברים החל משלב 15
        const advancedMathQuestions = [
            (num) => {
                const subtrahend1 = Math.floor(Math.random() * (num + 1));
                const addend1 = Math.floor(Math.random() * (21 - (num - subtrahend1)));
                const subtrahend2 = Math.floor(Math.random() * ((num - subtrahend1 + addend1) + 1));
                return { question: `${num} - ${subtrahend1} + ${addend1} - ${subtrahend2} = ?`, answer: num - subtrahend1 + addend1 - subtrahend2 };
            },
            (num) => {
                const addend1 = Math.floor(Math.random() * (21 - num));
                const subtrahend1 = Math.floor(Math.random() * (num + addend1 + 1));
                const addend2 = Math.floor(Math.random() * (21 - (num + addend1 - subtrahend1)));
                return { question: `${num} + ${addend1} - ${subtrahend1} + ${addend2} = ?`, answer: num + addend1 - subtrahend1 + addend2 };
            }
        ];

        let currentLevel = 0;

        const levels = numbers.map((num, index) => {
            if (index < 3) {
                return { question: `שים את ${animals[index]} על המספר ${num}`, answer: num, animal: animals[index] };
            } else if (index >= 4 && index < 14) {
                const mathQuestion = complexMathQuestions[index % complexMathQuestions.length](num);
                return { question: mathQuestion.question, answer: mathQuestion.answer, animal: animals[index] };
            } else if (index >= 14) {
                const mathQuestion = advancedMathQuestions[index % advancedMathQuestions.length](num);
                return { question: mathQuestion.question, answer: mathQuestion.answer, animal: animals[index] };
            } else {
                const mathQuestion = simpleMathQuestions[index % simpleMathQuestions.length](num);
                return { question: mathQuestion.question, answer: mathQuestion.answer, animal: animals[index] };
            }
        });

        function nextLevel() {
            currentLevel++;
            if (currentLevel < levels.length) {
                document.getElementById('question').textContent = levels[currentLevel].question;
                updateCursor(levels[currentLevel].animal);
                document.getElementById('feedback').textContent = '';
                document.getElementById('next-btn').classList.add('hidden');
                if ((currentLevel + 1) % 5 === 0) {
                    startMiniGame();
                }
            } else {
                document.getElementById('game').innerHTML = '<h2>סיימת את כל השלבים! כל הכבוד!</h2>';
                document.getElementById('animal-cursor').style.display = 'none';
            }
        }

        function updateCursor(animal) {
            const cursorElement = document.getElementById('animal-cursor');
            cursorElement.textContent = animal;
            document.body.style.cursor = `url('data:image/svg+xml,%3Csvg xmlns%3D"http%3A//www.w3.org/2000/svg" width%3D"32" height%3D"32" viewBox%3D"0 0 32 32"%3E%3Ctext y%3D"50%" x%3D"50%" font-size%3D"28" text-anchor%3D"middle" dy%3D".35em"%3E${encodeURIComponent(animal)}%3C/text%3E%3C/svg%3E'), auto`;
        }

        function showConfetti() {
            const confettiCanvas = document.getElementById('confetti-canvas');
            const confetti = new ConfettiGenerator({ target: confettiCanvas });
            confetti.render();
            setTimeout(() => confetti.clear(), 3000); // Clear confetti after 3 seconds
        }

        function addAnimalToFarm(animal, isSpecial = false) {
            const farmContainer = document.getElementById('farm-container');
            const animalIcon = document.createElement('div');
            animalIcon.className = isSpecial ? 'special-animal-icon' : 'animal-icon';
            animalIcon.textContent = animal;
            farmContainer.appendChild(animalIcon);
        }

        document.getElementById('number-line').addEventListener('mousemove', function(event) {
            const cursorElement = document.getElementById('animal-cursor');
            cursorElement.style.transform = `translate(${event.clientX}px, ${event.clientY}px)`;
        });

        document.getElementById('number-line').addEventListener('click', function(event) {
            const rect = this.getBoundingClientRect();
            const x = event.clientX - rect.left;

            const numberLineWidth = rect.width;
            const tickWidth = numberLineWidth / 20;
            const selectedNumber = Math.round(x / tickWidth);

            if (selectedNumber === levels[currentLevel].answer) {
                document.getElementById('feedback').textContent = "כל הכבוד! התשובה נכונה!";
                showConfetti();
                addAnimalToFarm(levels[currentLevel].animal);
                document.getElementById('next-btn').classList.remove('hidden');
            } else {
                document.getElementById('feedback').textContent = "לא נכון, נסה שוב.";
            }
        });

        function startMiniGame() {
            const minigameContainer = document.getElementById('minigame-container');
            const minigameTarget = document.getElementById('minigame-target');
            const minigameTimer = document.getElementById('minigame-timer');
            let timer = 20;

            minigameTarget.textContent = specialAnimals[Math.floor(Math.random() * specialAnimals.length)];
            minigameContainer.style.display = 'flex';

            const countdown = setInterval(() => {
                timer--;
                minigameTimer.textContent = timer;
                if (timer <= 0) {
                    clearInterval(countdown);
                    minigameContainer.style.display = 'none';
                }
            }, 1000);

            minigameTarget.addEventListener('click', function() {
                clearInterval(countdown);
                minigameContainer.style.display = 'none';
                addAnimalToFarm(minigameTarget.textContent, true);
            });
        }

        function init() {
            document.getElementById('question').textContent = levels[currentLevel].question;
            updateCursor(levels[currentLevel].animal);
        }

        window.onload = init;
    </script>
    <script src="https://cdn.jsdelivr.net/npm/confetti-js@0.0.18/dist/index.min.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9610203984741349"
     crossorigin="anonymous"></script>
</body>
</html>
