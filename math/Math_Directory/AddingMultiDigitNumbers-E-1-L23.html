<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ez42.live/global/analytics.js"></script>
    <script src="https://ez42.live/global/ads.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tsparticles/confetti@3.0.3/tsparticles.confetti.bundle.min.js"></script>
 	<link rel="stylesheet" href="http://www.ez42.live/global/styles/styles-eng.css"> <!-- Link to external CSS file -->
    <link rel="icon" type="image/svg+xml" href="http://www.ez42.live/global/styles/ez42-icon.svg">
    <title>✅ EZ42 LIVE - It's EZ</title>
    <!-- keywords: regrouping, carry over, place value, columns, adding up, sum, digits, ones place, tens place, hundreds place, align digits, vertical form, addition algorithm, breaking numbers, place holder, carrying, adding by place, place-value chart, addends, total   -->
</head>
<body>
    <div class="page-container">
        <div class="content-wrapper">

		<!--  Side Panel 1  -->
            <div id="sidePanel1" class="side-panel">
				<div class="logo-container">
					<a href="http://ez42.live" target="_blank" rel="noopener noreferrer">
						<img src="http://ez42.live/global/logo/logo.svg" alt="EZ42 Logo" class="logo-image">
					</a>
				</div>
			<h2>Instructions & Rules</h2>
			<ul>
																		<!--  PH1 - Instructions & Rules   -->
                <li>Read the text and questions carefully.</li>
                <li>Select the best answer.</li>
                <li>Click "Check Answers" when you're ready to see how you did!</li>
                <li>You can check your answers multiple times to improve your score.</li>
                <li>Correct answers are revealed after 10 attempts.</li>
                <li>You must answer all questions correctly to proceed to the next stage.</li>
				<li>Have fun!</li>
			</ul>
            </div>

		<!--  Quiz Panel   -->
            <div id="quizContainer" class="quiz-container">
																			<!--  PH2 - Title  X  2 : A1 - 📗 Green, A2 - 📘 Blue, B1 - 📒 Yellow, 📙 Orange, 📔 Beige, 📓 Gray , 📕 Red-->
                <h1>Adding Multi-Digit Numbers</h1>

                <div id="switchContainer" class="switch-container">
                    <div id="multiStateSwitch" class="switch">
                        <div class="switch-labels"></div>
                        <div class="switch-handle"></div>
                    </div>
                </div>
                <div id="tabContent"></div>
            </div>

		<!--  Side Panel 2  -->
			<div id="sidePanel2" class="side-panel">
				<h2>Animal Farm</h2>
				<p>Watch your farm grow as you progress! Each completed stage adds new animal friends to your collection.</p>
				<ul id="animalFarm" class="emoji-list">
				</ul>
			</div>
        </div>
    </div>
    <div id="copyright-container"></div>

    <!-- Modal -->
    <div id="quizModal" class="modal-quiz">
        <div class="modal-quiz-content">
            <span class="modal-quiz-close">&times;</span>
            <p id="modalMessage"></p>
            <button id="modalButton" class="modal-quiz-button">OK</button>
        </div>
    </div>
	<button id="scrollToTopBtn" title="Go to top">↑</button>
    <script>
        let isQuizExpanded = false;
        let allowQuizExpansion = true;

        let attempts = 0;
        let currentStage = 0;

        const manuallySetDefaultTab = 0;

																		//  PH3 - Quiz Data
        const quizData = [
				{
				  "stages": [
//-------------------------------------------------------------------------------------------------------------------

    // Stage 1
	{
    "text": "Let's help count different toys! Can you add the numbers together?",
    "questions": [
        {
            "question": "Tom has 2 cars and gets 2 more cars. How many cars does Tom have now?",
            "options": ["4 cars", "3 cars", "5 cars", "6 cars", "The cars drove away"],
            "answer": "4 cars"
        },
        {
            "question": "There are 4 dolls and 2 teddy bears. How many toys are there in total?",
            "options": ["6 toys", "5 toys", "7 toys", "4 toys", "They went to play"],
            "answer": "6 toys"
        },
        {
            "question": "If you have 1 block and find 4 more, how many blocks do you have?",
            "options": ["5 blocks", "6 blocks", "4 blocks", "3 blocks", "The blocks hid"],
            "answer": "5 blocks"
        },
        {
            "question": "Sam has 6 blue marbles and 1 red marble. How many marbles does Sam have?",
            "options": ["7 marbles", "6 marbles", "8 marbles", "5 marbles", "They rolled away"],
            "answer": "7 marbles"
        },
        {
            "question": "There are 2 balls and 6 robots. How many toys are there altogether?",
            "options": ["8 toys", "7 toys", "9 toys", "6 toys", "Toys took a nap"],
            "answer": "8 toys"
        }
      ]
    },
    // Stage 2
    {
    "text": "Let's count cookies! Can you help add up all the yummy cookies?",
    "questions": [
        {
            "question": "You have 5 chocolate cookies and get 2 more. How many cookies do you have now?",
            "options": ["7 cookies", "8 cookies", "6 cookies", "9 cookies", "Cookie Monster ate them"],
            "answer": "7 cookies"
        },
        {
            "question": "Mom baked 6 cookies and Dad baked 3 cookies. How many cookies did they bake together?",
            "options": ["9 cookies", "8 cookies", "10 cookies", "7 cookies", "The oven was sleeping"],
            "answer": "9 cookies"
        },
        {
            "question": "There are 4 cookies on one plate and 4 on another. How many cookies are there in total?",
            "options": ["8 cookies", "7 cookies", "9 cookies", "6 cookies", "Plates were empty"],
            "answer": "8 cookies"
        },
        {
            "question": "You find 5 cookies in the jar and 5 on the table. How many cookies are there?",
            "options": ["10 cookies", "9 cookies", "11 cookies", "8 cookies", "They became crumbs"],
            "answer": "10 cookies"
        },
        {
            "question": "If you have 3 cookies and your friend gives you 3 more, how many cookies do you have?",
            "options": ["6 cookies", "7 cookies", "5 cookies", "8 cookies", "Cookies ran away"],
            "answer": "6 cookies"
        }
      ]
    },
    // Stage 3
    {
    "text": "Time to count animals at the small farm! Can you help add them up?",
    "questions": [
        {
            "question": "There are 7 chickens and 4 ducks. How many birds are there altogether?",
            "options": ["11 birds", "12 birds", "10 birds", "13 birds", "They flew away"],
            "answer": "11 birds"
        },
        {
            "question": "If you see 6 white sheep and 7 brown sheep, how many sheep are there in total?",
            "options": ["13 sheep", "12 sheep", "14 sheep", "11 sheep", "They jumped over the moon"],
            "answer": "13 sheep"
        },
        {
            "question": "The farmer has 8 cows and 4 more. How many cows does the farmer have now?",
            "options": ["12 cows", "11 cows", "13 cows", "10 cows", "They went mooo-ving"],
            "answer": "12 cows"
        },
        {
            "question": "There are 5 big pigs and 5 little pigs. How many pigs are there in total?",
            "options": ["10 pigs", "11 pigs", "9 pigs", "12 pigs", "They made oink-oink"],
            "answer": "10 pigs"
        },
        {
            "question": "You count 9 rabbits and 5 more. How many rabbits are there now?",
            "options": ["14 rabbits", "13 rabbits", "15 rabbits", "12 rabbits", "They hopped away"],
            "answer": "14 rabbits"
        }
      ]
    },
    // Stage 4
    {
    "text": "Let's count fish in the aquarium! Help add up all the colorful fish swimming around.",
    "questions": [
        {
            "question": "There are 8 blue fish and 5 red fish. How many fish are there in total?",
            "options": ["13 fish", "14 fish", "12 fish", "15 fish", "They swam away"],
            "answer": "13 fish"
        },
        {
            "question": "You see 9 big fish and 6 small fish. How many fish do you see altogether?",
            "options": ["15 fish", "14 fish", "16 fish", "13 fish", "Fish went sleeping"],
            "answer": "15 fish"
        },
        {
            "question": "If there are 10 fish in one tank and 4 in another, how many fish are there in total?",
            "options": ["14 fish", "15 fish", "13 fish", "16 fish", "Tanks were empty"],
            "answer": "14 fish"
        },
        {
            "question": "You count 8 goldfish and 8 angelfish. How many fish did you count?",
            "options": ["16 fish", "15 fish", "17 fish", "14 fish", "Fish played hide and seek"],
            "answer": "16 fish"
        },
        {
            "question": "There are 6 fish swimming and 6 fish resting. How many fish are there?",
            "options": ["12 fish", "13 fish", "11 fish", "14 fish", "They took a vacation"],
            "answer": "12 fish"
        }
      ]
    },
    // Stage 5
    {
    "text": "Time to count flowers in the garden! Can you help add up all the pretty flowers?",
    "questions": [
        {
            "question": "You have 10 roses and plant 5 more. How many roses do you have now?",
            "options": ["15 roses", "14 roses", "16 roses", "13 roses", "Flowers danced away"],
            "answer": "15 roses"
        },
        {
            "question": "There are 8 red flowers and 9 yellow flowers. How many flowers in total?",
            "options": ["17 flowers", "16 flowers", "18 flowers", "15 flowers", "Wind blew them away"],
            "answer": "17 flowers"
        },
        {
            "question": "If you pick 7 daisies and 7 tulips, how many flowers did you pick?",
            "options": ["14 flowers", "15 flowers", "13 flowers", "16 flowers", "Bees took them"],
            "answer": "14 flowers"
        },
        {
            "question": "Mom planted 9 flowers and Dad planted 7. How many flowers did they plant together?",
            "options": ["16 flowers", "15 flowers", "17 flowers", "14 flowers", "Garden was sleeping"],
            "answer": "16 flowers"
        },
        {
            "question": "You find 13 flowers in one patch and 5 in another. How many flowers in total?",
            "options": ["18 flowers", "17 flowers", "19 flowers", "16 flowers", "Butterflies borrowed them"],
            "answer": "18 flowers"
        }
      ]
    },
    // Stage 6
    {
    "text": "Help count the balloons at the birthday party! How many balloons are there altogether?",
    "questions": [
        {
            "question": "There are 12 blue balloons and 4 red balloons. How many balloons in total?",
            "options": ["16 balloons", "15 balloons", "17 balloons", "14 balloons", "They popped!"],
            "answer": "16 balloons"
        },
        {
            "question": "You have 11 round balloons and 7 heart balloons. How many balloons do you have?",
            "options": ["18 balloons", "17 balloons", "19 balloons", "16 balloons", "They floated away"],
            "answer": "18 balloons"
        },
        {
            "question": "If you see 10 balloons inside and 5 outside, how many balloons are there?",
            "options": ["15 balloons", "16 balloons", "14 balloons", "17 balloons", "Wind took them"],
            "answer": "15 balloons"
        },
        {
            "question": "Mom bought 9 balloons and Dad bought 8. How many balloons did they buy?",
            "options": ["17 balloons", "16 balloons", "18 balloons", "15 balloons", "Store ran out"],
            "answer": "17 balloons"
        },
        {
            "question": "There are 7 small balloons and 7 big balloons. How many balloons altogether?",
            "options": ["14 balloons", "15 balloons", "13 balloons", "16 balloons", "Party ended early"],
            "answer": "14 balloons"
        }
      ]
    },
    // Stage 7
    {
    "text": "Time to count stickers in your new sticker book! Can you add them up?",
    "questions": [
        {
            "question": "You have 13 star stickers and 4 heart stickers. How many stickers in total?",
            "options": ["17 stickers", "18 stickers", "16 stickers", "19 stickers", "Pages stuck together"],
            "answer": "17 stickers"
        },
        {
            "question": "If you collect 12 animal stickers and 7 flower stickers, how many do you have?",
            "options": ["19 stickers", "18 stickers", "20 stickers", "17 stickers", "Book got wet"],
            "answer": "19 stickers"
        },
        {
            "question": "There are 11 sparkly stickers and 5 plain stickers. How many stickers altogether?",
            "options": ["16 stickers", "17 stickers", "15 stickers", "18 stickers", "Cat ate them"],
            "answer": "16 stickers"
        },
        {
            "question": "You find 14 stickers in one pack and 6 in another. How many stickers did you find?",
            "options": ["20 stickers", "19 stickers", "21 stickers", "18 stickers", "Wind blew them away"],
            "answer": "20 stickers"
        },
        {
            "question": "If you have 10 big stickers and 8 small stickers, how many stickers do you have?",
            "options": ["18 stickers", "17 stickers", "19 stickers", "16 stickers", "They disappeared"],
            "answer": "18 stickers"
        }
      ]
    },
    // Stage 8
    {
    "text": "Let's count crayons in the art class! How many crayons are there?",
    "questions": [
        {
            "question": "There are 15 long crayons and 4 short crayons. How many crayons in total?",
            "options": ["19 crayons", "18 crayons", "20 crayons", "17 crayons", "They melted away"],
            "answer": "19 crayons"
        },
        {
            "question": "You have 12 new crayons and 9 old crayons. How many crayons do you have?",
            "options": ["21 crayons", "20 crayons", "22 crayons", "19 crayons", "Art class canceled"],
            "answer": "21 crayons"
        },
        {
            "question": "If you find 14 crayons in one box and 6 in another, how many crayons did you find?",
            "options": ["20 crayons", "19 crayons", "21 crayons", "18 crayons", "Boxes were empty"],
            "answer": "20 crayons"
        },
        {
            "question": "There are 11 thick crayons and 6 thin crayons. How many crayons altogether?",
            "options": ["17 crayons", "18 crayons", "16 crayons", "19 crayons", "They ran away"],
            "answer": "17 crayons"
        },
        {
            "question": "You count 13 crayons on the desk and 5 in your bag. How many crayons are there?",
            "options": ["18 crayons", "17 crayons", "19 crayons", "16 crayons", "Desk was clean"],
            "answer": "18 crayons"
        }
      ]
    },
    // Stage 9
    {
    "text": "Time to count marbles in your collection! Can you add them all up?",
    "questions": [
        {
            "question": "You have 16 glass marbles and 5 wooden marbles. How many marbles in total?",
            "options": ["21 marbles", "20 marbles", "22 marbles", "19 marbles", "They rolled away"],
            "answer": "21 marbles"
        },
        {
            "question": "If you find 15 big marbles and 8 small marbles, how many marbles did you find?",
            "options": ["23 marbles", "22 marbles", "24 marbles", "21 marbles", "Cat played with them"],
            "answer": "23 marbles"
        },
        {
            "question": "There are 14 blue marbles and 6 red marbles. How many marbles altogether?",
            "options": ["20 marbles", "21 marbles", "19 marbles", "22 marbles", "Dog hid them"],
            "answer": "20 marbles"
        },
        {
            "question": "You count 17 smooth marbles and 7 sparkly marbles. How many marbles are there?",
            "options": ["24 marbles", "23 marbles", "25 marbles", "22 marbles", "Pocket had holes"],
            "answer": "24 marbles"
        },
        {
            "question": "If you have 13 old marbles and 9 new marbles, how many marbles do you have?",
            "options": ["22 marbles", "21 marbles", "23 marbles", "20 marbles", "Marbles disappeared"],
            "answer": "22 marbles"
        }
      ]
    },
    // Stage 10
    {
    "text": "Let's count pencils in the classroom! How many pencils are there?",
    "questions": [
        {
            "question": "There are 18 yellow pencils and 4 red pencils. How many pencils in total?",
            "options": ["22 pencils", "23 pencils", "21 pencils", "24 pencils", "Break time started"],
            "answer": "22 pencils"
        },
        {
            "question": "You find 16 long pencils and 8 short pencils. How many pencils did you find?",
            "options": ["24 pencils", "23 pencils", "25 pencils", "22 pencils", "Pencils needed sharpening"],
            "answer": "24 pencils"
        },
        {
            "question": "If you have 15 new pencils and 6 old pencils, how many pencils do you have?",
            "options": ["21 pencils", "22 pencils", "20 pencils", "23 pencils", "They broke in half"],
            "answer": "21 pencils"
        },
        {
            "question": "You count 17 wooden pencils and 8 mechanical pencils. How many pencils are there?",
            "options": ["25 pencils", "24 pencils", "26 pencils", "23 pencils", "Class was over"],
            "answer": "25 pencils"
        },
        {
            "question": "There are 14 sharp pencils and 9 dull pencils. How many pencils altogether?",
            "options": ["23 pencils", "22 pencils", "24 pencils", "21 pencils", "Teacher took them"],
            "answer": "23 pencils"
        }
      ]
    },
    // Stage 11
    {
    "text": "Help count the books on the library shelves! How many books are there?",
    "questions": [
        {
            "question": "You see 19 story books and 4 picture books. How many books in total?",
            "options": ["23 books", "22 books", "24 books", "21 books", "Library closed early"],
            "answer": "23 books"
        },
        {
            "question": "There are 17 thin books and 8 thick books. How many books altogether?",
            "options": ["25 books", "24 books", "26 books", "23 books", "Books went to sleep"],
            "answer": "25 books"
        },
        {
            "question": "If you count 16 new books and 6 old books, how many books did you count?",
            "options": ["22 books", "23 books", "21 books", "24 books", "Pages fell out"],
            "answer": "22 books"
        },
        {
            "question": "You find 18 small books and 8 big books. How many books did you find?",
            "options": ["26 books", "25 books", "27 books", "24 books", "Bookworms ate them"],
            "answer": "26 books"
        },
        {
            "question": "There are 15 comic books and 9 puzzle books. How many books in total?",
            "options": ["24 books", "23 books", "25 books", "22 books", "Shelf broke down"],
            "answer": "24 books"
        }
      ]
    },
    // Stage 12
    {
    "text": "Count the candies in the candy shop! How many sweet treats are there?",
    "questions": [
        {
            "question": "There are 20 lollipops and 5 chocolate bars. How many candies in total?",
            "options": ["25 candies", "24 candies", "26 candies", "23 candies", "Sugar melted away"],
            "answer": "25 candies"
        },
        {
            "question": "You have 18 hard candies and 9 soft candies. How many candies do you have?",
            "options": ["27 candies", "26 candies", "28 candies", "25 candies", "Teeth got cavity"],
            "answer": "27 candies"
        },
        {
            "question": "If there are 19 wrapped candies and 4 unwrapped candies, how many candies total?",
            "options": ["23 candies", "24 candies", "22 candies", "25 candies", "Sweet dreams!"],
            "answer": "23 candies"
        },
        {
            "question": "You count 21 mint candies and 8 fruit candies. How many candies did you count?",
            "options": ["29 candies", "28 candies", "30 candies", "27 candies", "Candy vanished"],
            "answer": "29 candies"
        },
        {
            "question": "There are 17 small candies and 9 big candies. How many candies altogether?",
            "options": ["26 candies", "25 candies", "27 candies", "24 candies", "Too sweet to count"],
            "answer": "26 candies"
        }
      ]
    },
    // Stage 13
    {
    "text": "Help count the building blocks! How many blocks are in the toy box?",
    "questions": [
        {
            "question": "You have 22 red blocks and 5 blue blocks. How many blocks in total?",
            "options": ["27 blocks", "26 blocks", "28 blocks", "25 blocks", "Tower fell down"],
            "answer": "27 blocks"
        },
        {
            "question": "There are 20 square blocks and 9 round blocks. How many blocks altogether?",
            "options": ["29 blocks", "28 blocks", "30 blocks", "27 blocks", "Blocks rolled away"],
            "answer": "29 blocks"
        },
        {
            "question": "If you find 21 wooden blocks and 4 plastic blocks, how many blocks did you find?",
            "options": ["25 blocks", "26 blocks", "24 blocks", "27 blocks", "Box was empty"],
            "answer": "25 blocks"
        },
        {
            "question": "You count 19 big blocks and 9 small blocks. How many blocks are there?",
            "options": ["28 blocks", "27 blocks", "29 blocks", "26 blocks", "Blocks took a nap"],
            "answer": "28 blocks"
        },
        {
            "question": "There are 23 old blocks and 7 new blocks. How many blocks in total?",
            "options": ["30 blocks", "29 blocks", "31 blocks", "28 blocks", "They disappeared"],
            "answer": "30 blocks"
        }
      ]
    },
    // Stage 14
    {
    "text": "Count the seashells on the beach! How many shells did you find?",
    "questions": [
        {
            "question": "You collect 23 white shells and 5 pink shells. How many shells in total?",
            "options": ["28 shells", "27 shells", "29 shells", "26 shells", "Waves took them"],
            "answer": "28 shells"
        },
        {
            "question": "There are 21 small shells and 9 big shells. How many shells altogether?",
            "options": ["30 shells", "29 shells", "31 shells", "28 shells", "Crabs borrowed them"],
            "answer": "30 shells"
        },
        {
            "question": "If you find 24 smooth shells and 8 rough shells, how many shells did you find?",
            "options": ["32 shells", "31 shells", "33 shells", "30 shells", "Sand covered them"],
            "answer": "32 shells"
        },
        {
            "question": "You count 22 spiral shells and 7 flat shells. How many shells are there?",
            "options": ["29 shells", "28 shells", "30 shells", "27 shells", "Tide washed them"],
            "answer": "29 shells"
        },
        {
            "question": "There are 25 beach shells and 6 river shells. How many shells in total?",
            "options": ["31 shells", "30 shells", "32 shells", "29 shells", "Mermaid kept them"],
            "answer": "31 shells"
        }
      ]
    },
    // Stage 15
    {
    "text": "Count the vegetables in the garden! How many veggies are growing?",
    "questions": [
        {
            "question": "You see 24 carrots and 6 tomatoes. How many vegetables in total?",
            "options": ["30 vegetables", "29 vegetables", "31 vegetables", "28 vegetables", "Rabbits ate them"],
            "answer": "30 vegetables"
        },
        {
            "question": "There are 22 peas and 10 cucumbers. How many vegetables altogether?",
            "options": ["32 vegetables", "31 vegetables", "33 vegetables", "30 vegetables", "Garden dried up"],
            "answer": "32 vegetables"
        },
        {
            "question": "If you count 25 lettuce and 9 peppers, how many vegetables did you count?",
            "options": ["34 vegetables", "33 vegetables", "35 vegetables", "32 vegetables", "Bugs ate them"],
            "answer": "34 vegetables"
        },
        {
            "question": "You find 23 beans and 8 radishes. How many vegetables did you find?",
            "options": ["31 vegetables", "30 vegetables", "32 vegetables", "29 vegetables", "Wind blew them"],
            "answer": "31 vegetables"
        },
        {
            "question": "There are 26 potatoes and 7 onions. How many vegetables in total?",
            "options": ["33 vegetables", "32 vegetables", "34 vegetables", "31 vegetables", "Forgot to water"],
            "answer": "33 vegetables"
        }
      ]
    },
    // Stage 16
    {
    "text": "Count the stars in the night sky! How many stars can you see?",
    "questions": [
        {
            "question": "You spot 25 bright stars and 7 dim stars. How many stars in total?",
            "options": ["32 stars", "31 stars", "33 stars", "30 stars", "Clouds covered them"],
            "answer": "32 stars"
        },
        {
            "question": "There are 23 white stars and 11 blue stars. How many stars altogether?",
            "options": ["34 stars", "33 stars", "35 stars", "32 stars", "Sun came up"],
            "answer": "34 stars"
        },
        {
            "question": "If you see 26 big stars and 7 small stars, how many stars did you see?",
            "options": ["33 stars", "32 stars", "34 stars", "31 stars", "Stars went sleeping"],
            "answer": "33 stars"
        },
        {
            "question": "You count 24 twinkling stars and 11 steady stars. How many stars are there?",
            "options": ["35 stars", "34 stars", "36 stars", "33 stars", "Moon blocked them"],
            "answer": "35 stars"
        },
        {
            "question": "There are 27 far stars and 9 close stars. How many stars in total?",
            "options": ["36 stars", "35 stars", "37 stars", "34 stars", "Too dark to see"],
            "answer": "36 stars"
        }
      ]
    },
    // Stage 17
    {
    "text": "Count the butterflies in the garden! How many butterflies are flying?",
    "questions": [
        {
            "question": "You see 26 orange butterflies and 8 yellow butterflies. How many in total?",
            "options": ["34 butterflies", "33 butterflies", "35 butterflies", "32 butterflies", "They flew away"],
            "answer": "34 butterflies"
        },
        {
            "question": "There are 25 big butterflies and 11 small butterflies. How many altogether?",
            "options": ["36 butterflies", "35 butterflies", "37 butterflies", "34 butterflies", "Rain scared them"],
            "answer": "36 butterflies"
        },
        {
            "question": "If you count 27 spotted butterflies and 10 plain butterflies, how many total?",
            "options": ["37 butterflies", "36 butterflies", "38 butterflies", "35 butterflies", "Wind blew them"],
            "answer": "37 butterflies"
        },
        {
            "question": "You find 24 flying butterflies and 11 resting butterflies. How many are there?",
            "options": ["35 butterflies", "34 butterflies", "36 butterflies", "33 butterflies", "Too fast to count"],
            "answer": "35 butterflies"
        },
        {
            "question": "There are 28 old butterflies and 10 new butterflies. How many in total?",
            "options": ["38 butterflies", "37 butterflies", "39 butterflies", "36 butterflies", "Garden closed"],
            "answer": "38 butterflies"
        }
      ]
    },
    // Stage 18
    {
    "text": "Count the ice cream scoops! How many scoops are in the ice cream shop?",
    "questions": [
        {
            "question": "You have 27 chocolate scoops and 9 vanilla scoops. How many in total?",
            "options": ["36 scoops", "35 scoops", "37 scoops", "34 scoops", "Ice cream melted"],
            "answer": "36 scoops"
        },
        {
            "question": "There are 26 strawberry scoops and 12 mint scoops. How many altogether?",
            "options": ["38 scoops", "37 scoops", "39 scoops", "36 scoops", "Too cold to count"],
            "answer": "38 scoops"
        },
        {
            "question": "If you count 28 big scoops and 11 small scoops, how many scoops total?",
            "options": ["39 scoops", "38 scoops", "40 scoops", "37 scoops", "Freezer broke"],
            "answer": "39 scoops"
        },
        {
            "question": "You see 25 soft scoops and 12 hard scoops. How many scoops are there?",
            "options": ["37 scoops", "36 scoops", "38 scoops", "35 scoops", "Shop closed early"],
            "answer": "37 scoops"
        },
        {
            "question": "There are 29 cold scoops and 11 melting scoops. How many in total?",
            "options": ["40 scoops", "39 scoops", "41 scoops", "38 scoops", "Summer was hot"],
            "answer": "40 scoops"
        }
      ]
    },
    // Stage 19
    {
    "text": "Count the paper airplanes! How many planes did the class make?",
    "questions": [
        {
            "question": "You make 28 white planes and 10 colored planes. How many in total?",
            "options": ["38 planes", "37 planes", "39 planes", "36 planes", "Wind took them"],
            "answer": "38 planes"
        },
        {
            "question": "There are 27 small planes and 13 large planes. How many altogether?",
            "options": ["40 planes", "39 planes", "41 planes", "38 planes", "They flew away"],
            "answer": "40 planes"
        },
        {
            "question": "If you count 29 paper planes and 12 cardboard planes, how many total?",
            "options": ["41 planes", "40 planes", "42 planes", "39 planes", "Rain ruined them"],
            "answer": "41 planes"
        },
        {
            "question": "You see 26 flying planes and 11 landed planes. How many planes are there?",
            "options": ["37 planes", "36 planes", "38 planes", "35 planes", "Too high to count"],
            "answer": "37 planes"
        },
        {
            "question": "There are 30 smooth planes and 9 crumpled planes. How many in total?",
            "options": ["39 planes", "38 planes", "40 planes", "37 planes", "Paper ran out"],
            "answer": "39 planes"
        }
      ]
    },
    // Stage  20
    {
    "text": "Count the leaves on the autumn trees! How many leaves can you see?",
    "questions": [
        {
            "question": "You find 29 red leaves and 11 yellow leaves. How many leaves in total?",
            "options": ["40 leaves", "39 leaves", "41 leaves", "38 leaves", "Wind blew them"],
            "answer": "40 leaves"
        },
        {
            "question": "There are 28 maple leaves and 14 oak leaves. How many leaves altogether?",
            "options": ["42 leaves", "41 leaves", "43 leaves", "40 leaves", "Trees went bare"],
            "answer": "42 leaves"
        },
        {
            "question": "If you count 30 big leaves and 13 small leaves, how many leaves total?",
            "options": ["43 leaves", "42 leaves", "44 leaves", "41 leaves", "Autumn ended"],
            "answer": "43 leaves"
        },
        {
            "question": "You see 27 dry leaves and 12 wet leaves. How many leaves are there?",
            "options": ["39 leaves", "38 leaves", "40 leaves", "37 leaves", "Rain washed them"],
            "answer": "39 leaves"
        },
        {
            "question": "There are 31 falling leaves and 10 floating leaves. How many in total?",
            "options": ["41 leaves", "40 leaves", "42 leaves", "39 leaves", "Too windy to count"],
            "answer": "41 leaves"
        }
      ]
    },
    // Stage 21
    {
    "text": "Count the snowflakes falling! How many snowflakes can you see?",
    "questions": [
        {
            "question": "You spot 30 white snowflakes and 12 crystal snowflakes. How many total?",
            "options": ["42 snowflakes", "41 snowflakes", "43 snowflakes", "40 snowflakes", "Sun melted them"],
            "answer": "42 snowflakes"
        },
        {
            "question": "There are 31 big snowflakes and 13 small snowflakes. How many altogether?",
            "options": ["44 snowflakes", "43 snowflakes", "45 snowflakes", "42 snowflakes", "Too cold to count"],
            "answer": "44 snowflakes"
        },
        {
            "question": "If you count 29 falling snowflakes and 11 floating ones, how many total?",
            "options": ["40 snowflakes", "41 snowflakes", "39 snowflakes", "42 snowflakes", "Wind blew them"],
            "answer": "40 snowflakes"
        },
        {
            "question": "You find 32 sparkling snowflakes and 13 dull ones. How many are there?",
            "options": ["45 snowflakes", "44 snowflakes", "46 snowflakes", "43 snowflakes", "Spring came early"],
            "answer": "45 snowflakes"
        },
        {
            "question": "There are 28 light snowflakes and 15 heavy ones. How many in total?",
            "options": ["43 snowflakes", "42 snowflakes", "44 snowflakes", "41 snowflakes", "Started raining"],
            "answer": "43 snowflakes"
        }
      ]
    },
    // Stage 22
    {
    "text": "Count the colorful balloons at the party! How many balloons are there?",
    "questions": [
        {
            "question": "You have 31 round balloons and 13 heart balloons. How many total?",
            "options": ["44 balloons", "43 balloons", "45 balloons", "42 balloons", "Party ended"],
            "answer": "44 balloons"
        },
        {
            "question": "There are 32 floating balloons and 14 tied balloons. How many altogether?",
            "options": ["46 balloons", "45 balloons", "47 balloons", "44 balloons", "They popped"],
            "answer": "46 balloons"
        },
        {
            "question": "If you count 30 big balloons and 12 small ones, how many total?",
            "options": ["42 balloons", "43 balloons", "41 balloons", "44 balloons", "Helium ran out"],
            "answer": "42 balloons"
        },
        {
            "question": "You see 33 red balloons and 14 blue ones. How many are there?",
            "options": ["47 balloons", "46 balloons", "48 balloons", "45 balloons", "Too high to reach"],
            "answer": "47 balloons"
        },
        {
            "question": "There are 29 new balloons and 16 old ones. How many in total?",
            "options": ["45 balloons", "44 balloons", "46 balloons", "43 balloons", "Birthday canceled"],
            "answer": "45 balloons"
        }
      ]
    },
    // Stage 23
    {
    "text": "Count the happy birds in the park! How many birds do you see?",
    "questions": [
        {
            "question": "You spot 32 sparrows and 14 robins. How many birds total?",
            "options": ["46 birds", "45 birds", "47 birds", "44 birds", "They flew south"],
            "answer": "46 birds"
        },
        {
            "question": "There are 33 singing birds and 15 quiet birds. How many altogether?",
            "options": ["48 birds", "47 birds", "49 birds", "46 birds", "Cat scared them"],
            "answer": "48 birds"
        },
        {
            "question": "If you count 31 small birds and 13 large birds, how many total?",
            "options": ["44 birds", "45 birds", "43 birds", "46 birds", "Rain started"],
            "answer": "44 birds"
        },
        {
            "question": "You find 34 flying birds and 15 nesting birds. How many are there?",
            "options": ["49 birds", "48 birds", "50 birds", "47 birds", "Too fast to count"],
            "answer": "49 birds"
        },
        {
            "question": "There are 30 brown birds and 17 colorful birds. How many in total?",
            "options": ["47 birds", "46 birds", "48 birds", "45 birds", "Night came"],
            "answer": "47 birds"
        }
      ]
    },
    // Stage 24
    {
    "text": "Count the pretty flowers in the meadow! How many flowers are there?",
    "questions": [
        {
            "question": "You see 33 daisies and 15 roses. How many flowers total?",
            "options": ["48 flowers", "47 flowers", "49 flowers", "46 flowers", "Bees took them"],
            "answer": "48 flowers"
        },
        {
            "question": "There are 34 tall flowers and 16 short flowers. How many altogether?",
            "options": ["50 flowers", "49 flowers", "51 flowers", "48 flowers", "Wind blew them"],
            "answer": "50 flowers"
        },
        {
            "question": "If you count 32 white flowers and 14 pink ones, how many total?",
            "options": ["46 flowers", "47 flowers", "45 flowers", "48 flowers", "Garden closed"],
            "answer": "46 flowers"
        },
        {
            "question": "You find 35 blooming flowers and 16 buds. How many are there?",
            "options": ["51 flowers", "50 flowers", "52 flowers", "49 flowers", "Winter came"],
            "answer": "51 flowers"
        },
        {
            "question": "There are 31 fresh flowers and 18 wilted ones. How many in total?",
            "options": ["49 flowers", "48 flowers", "50 flowers", "47 flowers", "Forgot to water"],
            "answer": "49 flowers"
        }
      ]
    },
    // Stage 25
    {
    "text": "Count the tasty cookies in the bakery! How many cookies are there?",
    "questions": [
        {
            "question": "You have 34 chocolate cookies and 16 sugar cookies. How many total?",
            "options": ["50 cookies", "49 cookies", "51 cookies", "48 cookies", "All eaten up"],
            "answer": "50 cookies"
        },
        {
            "question": "There are 35 round cookies and 17 star cookies. How many altogether?",
            "options": ["52 cookies", "51 cookies", "53 cookies", "50 cookies", "Oven too hot"],
            "answer": "52 cookies"
        },
        {
            "question": "If you count 33 big cookies and 15 small ones, how many total?",
            "options": ["48 cookies", "49 cookies", "47 cookies", "50 cookies", "Timer rang"],
            "answer": "48 cookies"
        },
        {
            "question": "You see 36 soft cookies and 17 crunchy ones. How many are there?",
            "options": ["53 cookies", "52 cookies", "54 cookies", "51 cookies", "Got too crispy"],
            "answer": "53 cookies"
        },
        {
            "question": "There are 32 fresh cookies and 19 day-old ones. How many in total?",
            "options": ["51 cookies", "50 cookies", "52 cookies", "49 cookies", "Crumbs only"],
            "answer": "51 cookies"
        }
      ]
    },
    // Stage 26
    {
    "text": "Count the toy cars in the race! How many cars are racing?",
    "questions": [
        {
            "question": "You have 35 red cars and 16 blue cars. How many cars total?",
            "options": ["51 cars", "50 cars", "52 cars", "49 cars", "Race canceled"],
            "answer": "51 cars"
        },
        {
            "question": "There are 36 fast cars and 17 slow cars. How many altogether?",
            "options": ["53 cars", "52 cars", "54 cars", "51 cars", "Batteries died"],
            "answer": "53 cars"
        },
        {
            "question": "If you count 34 small cars and 15 big ones, how many total?",
            "options": ["49 cars", "50 cars", "48 cars", "51 cars", "Track broke"],
            "answer": "49 cars"
        },
        {
            "question": "You see 37 racing cars and 18 parked cars. How many cars are there?",
            "options": ["55 cars", "54 cars", "56 cars", "53 cars", "Too fast to see"],
            "answer": "55 cars"
        },
        {
            "question": "There are 33 new cars and 19 old cars. How many in total?",
            "options": ["52 cars", "51 cars", "53 cars", "50 cars", "Wheels fell off"],
            "answer": "52 cars"
        }
      ]
    },
    // Stage 27
    {
    "text": "Count the colorful beads for your necklace! How many beads are there?",
    "questions": [
        {
            "question": "You have 36 round beads and 17 square beads. How many total?",
            "options": ["53 beads", "52 beads", "54 beads", "51 beads", "String broke"],
            "answer": "53 beads"
        },
        {
            "question": "There are 37 glass beads and 18 wooden beads. How many altogether?",
            "options": ["55 beads", "54 beads", "56 beads", "53 beads", "Too shiny to count"],
            "answer": "55 beads"
        },
        {
            "question": "If you count 35 small beads and 16 large ones, how many total?",
            "options": ["51 beads", "52 beads", "50 beads", "53 beads", "Beads scattered"],
            "answer": "51 beads"
        },
        {
            "question": "You see 38 colorful beads and 19 plain ones. How many are there?",
            "options": ["57 beads", "56 beads", "58 beads", "55 beads", "Box spilled"],
            "answer": "57 beads"
        },
        {
            "question": "There are 34 shiny beads and 20 dull ones. How many in total?",
            "options": ["54 beads", "53 beads", "55 beads", "52 beads", "Lost the beads"],
            "answer": "54 beads"
        }
      ]
    },
    // Stage 28
    {
    "text": "Count the bright stars in the night sky! How many stars can you see?",
    "questions": [
        {
            "question": "You spot 37 white stars and 18 golden stars. How many total?",
            "options": ["55 stars", "54 stars", "56 stars", "53 stars", "Clouds came"],
            "answer": "55 stars"
        },
        {
            "question": "There are 38 big stars and 19 small stars. How many altogether?",
            "options": ["57 stars", "56 stars", "58 stars", "55 stars", "Sun rose"],
            "answer": "57 stars"
        },
        {
            "question": "If you count 36 bright stars and 17 dim ones, how many total?",
            "options": ["53 stars", "54 stars", "52 stars", "55 stars", "Too dark now"],
            "answer": "53 stars"
        },
        {
            "question": "You find 39 twinkling stars and 20 steady ones. How many are there?",
            "options": ["59 stars", "58 stars", "60 stars", "57 stars", "Moon blocked them"],
            "answer": "59 stars"
        },
        {
            "question": "There are 35 far stars and 21 close stars. How many in total?",
            "options": ["56 stars", "55 stars", "57 stars", "54 stars", "Stars went sleeping"],
            "answer": "56 stars"
        }
      ]
    },
    // Stage 29
    {
    "text": "Count the rainbow drops on the leaves! How many drops can you see?",
    "questions": [
        {
            "question": "You see 38 clear drops and 19 sparkly drops. How many total?",
            "options": ["57 drops", "56 drops", "58 drops", "55 drops", "Sun dried them"],
            "answer": "57 drops"
        },
        {
            "question": "There are 39 big drops and 20 small drops. How many altogether?",
            "options": ["59 drops", "58 drops", "60 drops", "57 drops", "Wind shook them"],
            "answer": "59 drops"
        },
        {
            "question": "If you count 37 morning drops and 18 evening drops, how many total?",
            "options": ["55 drops", "56 drops", "54 drops", "57 drops", "Too wet to count"],
            "answer": "55 drops"
        },
        {
            "question": "You find 40 water drops and 21 dew drops. How many are there?",
            "options": ["61 drops", "60 drops", "62 drops", "59 drops", "Leaves fell off"],
            "answer": "61 drops"
        },
        {
            "question": "There are 36 round drops and 22 oval drops. How many in total?",
            "options": ["58 drops", "57 drops", "59 drops", "56 drops", "Rain stopped"],
            "answer": "58 drops"
        }
      ]
    },
    // Stage 30
    {
    "text": "Count the happy children at the playground! How many children are playing?",
    "questions": [
        {
            "question": "You see 39 running children and 20 walking children. How many total?",
            "options": ["59 children", "58 children", "60 children", "57 children", "Recess ended"],
            "answer": "59 children"
        },
        {
            "question": "There are 40 jumping children and 21 sitting children. How many altogether?",
            "options": ["61 children", "60 children", "62 children", "59 children", "Time to go home"],
            "answer": "61 children"
        },
        {
            "question": "If you count 38 laughing children and 19 quiet ones, how many total?",
            "options": ["57 children", "58 children", "56 children", "59 children", "Bell rang"],
            "answer": "57 children"
        },
        {
            "question": "You find 41 playing children and 22 watching children. How many are there?",
            "options": ["63 children", "62 children", "64 children", "61 children", "Rain started"],
            "answer": "63 children"
        },
        {
            "question": "There are 37 happy children and 23 tired children. How many in total?",
            "options": ["60 children", "59 children", "61 children", "58 children", "Nap time came"],
            "answer": "60 children"
        }
    ]
	}
//-------------------------------------------------------------------------------------------------------------------
				  ]
				}
        ];

		const stageCount = quizData[0].stages.length; // This is the correct way to get the number of stages


		const stateContents = {
			'Practice': `<div id="stage-number" class="stage-number">Stage 1 of ${stageCount}</div><div class="progress-bar-container"><div id="progress-bar" class="progress-bar"></div></div><div id="attempts">Attempts: 0</div><div id="quiz-content"></div><button class="center-button" onclick="checkStage()">Check Answers</button>`
			,'Subject Overview 🗝️': `<div class="subject-overview-content">     <h1>Adding Multi-Digit Numbers: A Fun Guide for Kids</h1>     <p>Adding multi-digit numbers is an important math skill that helps us solve bigger problems. When we add numbers with more than one digit, we use place value to make sure each digit is added correctly. This guide will help you understand how to add multi-digit numbers step by step with easy examples!</p>     <hr>     <h2>Table of Contents</h2>     <ol>         <li><a href="#what-is-adding-multi-digit-numbers">What is Adding Multi-Digit Numbers?</a></li>         <li><a href="#understanding-place-value">Understanding Place Value</a></li>         <li><a href="#step-by-step-addition">Step-by-Step Addition</a>             <ul>                 <li><a href="#step-1">Step 1: Write the Numbers Vertically</a></li>                 <li><a href="#step-2">Step 2: Add the Ones Place</a></li>                 <li><a href="#step-3">Step 3: Carry Over if Needed</a></li>                 <li><a href="#step-4">Step 4: Add the Tens Place</a></li>                 <li><a href="#step-5">Step 5: Continue Adding Larger Places</a></li>             </ul>         </li>         <li><a href="#examples">Examples</a></li>         <li><a href="#tips-and-tricks">Tips and Tricks</a></li>         <li><a href="#conclusion">Conclusion</a></li>     </ol>     <hr>     <h2 id="what-is-adding-multi-digit-numbers">What is Adding Multi-Digit Numbers?</h2>     <p>Adding multi-digit numbers means adding numbers that have more than one digit, like 23 + 45. It’s like adding bigger numbers by breaking them down into smaller, easier parts.</p>     <hr>     <h2 id="understanding-place-value">Understanding Place Value</h2>     <p>Place value helps us know the value of each digit in a number based on its position. In a two-digit number like 34:</p>     <ul>         <li><strong>3</strong> is in the <em>tens</em> place and means 30.</li>         <li><strong>4</strong> is in the <em>ones</em> place and means 4.</li>     </ul>     <p>Understanding place value is key to adding multi-digit numbers correctly.</p>     <hr>     <h2 id="step-by-step-addition">Step-by-Step Addition</h2>         <h3 id="step-1">Step 1: Write the Numbers Vertically</h3>     <p>Write the numbers you want to add one below the other, making sure the ones, tens, hundreds places, etc., line up.</p>     <hr>         <h3 id="step-2">Step 2: Add the Ones Place</h3>     <p>Start adding from the rightmost digit, the ones place.</p>     <hr>         <h3 id="step-3">Step 3: Carry Over if Needed</h3>     <p>If the sum of the ones place is 10 or more, carry over the extra value to the next place (tens).</p>     <hr>         <h3 id="step-4">Step 4: Add the Tens Place</h3>     <p>Add the digits in the tens place, including any carry-over from the ones place.</p>     <hr>         <h3 id="step-5">Step 5: Continue Adding Larger Places</h3>     <p>If you have numbers with hundreds, thousands, etc., continue the same process for each place.</p>     <hr>         <h2 id="examples">Examples</h2>     <h3>Example 1: Adding 23 + 45</h3>     <ol>         <li>Write the numbers vertically:             <pre>   23 + 45 ----             </pre>         </li>         <li>Add the ones place: 3 + 5 = 8.</li>         <li>Add the tens place: 2 + 4 = 6.</li>         <li>The sum is 68.</li>     </ol>         <h3>Example 2: Adding 157 + 289</h3>     <ol>         <li>Write the numbers vertically:             <pre>   157 + 289 -----             </pre>         </li>         <li>Add the ones place: 7 + 9 = 16. Write down 6 and carry over 1.</li>         <li>Add the tens place: 5 + 8 + 1 (carry) = 14. Write down 4 and carry over 1.</li>         <li>Add the hundreds place: 1 + 2 + 1 (carry) = 4.</li>         <li>The sum is 446.</li>     </ol>     <hr>     <h2 id="tips-and-tricks">Tips and Tricks</h2>     <ul>         <li><strong>Use a Pencil and Paper:</strong> It helps to write down each step clearly.</li>         <li><strong>Double-Check Your Work:</strong> Go through each step again to make sure you didn’t make a mistake.</li>         <li><strong>Practice Regularly:</strong> The more you practice, the better you’ll get!</li>         <li><strong>Use Visual Aids:</strong> Tools like number lines or base-ten blocks can help you understand place value.</li>     </ul>     <hr>     <h2 id="conclusion">Conclusion</h2>     <p>Adding multi-digit numbers is a fun and essential math skill that you can master with practice. Remember to line up the numbers by place value, add each place step by step, and carry over when needed. Keep practicing these steps, and soon you’ll be adding big numbers with ease!</p>     <hr>     <p>Keep practicing your addition skills and use the tips and examples in this guide to become a math whiz! Don’t forget to ask for help if you need it, and most importantly, have fun with math!</p> </div>
`
			};


        function setQuizExpansion(allow) {
            allowQuizExpansion = allow;
            adjustLayout();
        }

        function adjustLayout() {
            const wrapper = document.querySelector('.content-wrapper');
            const quizContainer = document.getElementById('quizContainer');
            const sidePanel1 = document.getElementById('sidePanel1');

            const isPanel1Visible = window.getComputedStyle(sidePanel1).display !== 'none';

            wrapper.style.justifyContent = 'space-between';

            if (isPanel1Visible) {
                sidePanel1.style.flex = '0 0 calc(20% - 0.5rem)';
                sidePanel1.style.maxWidth = 'calc(20% - 0.5rem)';
                quizContainer.style.flex = '1';
            } else {
                quizContainer.style.flex = '1';
                wrapper.style.justifyContent = 'center';
            }

            [sidePanel1, quizContainer].forEach(el => {
                el.style.display = 'block';
            });
        }

        function togglePanel(panelId) {
            const panel = document.getElementById(panelId);
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
            adjustLayout();
        }

        function updateSwitcherLayout() {
            const switchElement = document.getElementById('multiStateSwitch');
            const labels = switchElement.querySelectorAll('.switch-label');
            const handle = switchElement.querySelector('.switch-handle');

            labels.forEach(label => {
                label.style.flex = 'none';
                label.style.padding = '0 20px';
            });

            const activeLabel = switchElement.querySelector('.switch-label.active');
            if (activeLabel) {
                const switchRect = switchElement.getBoundingClientRect();
                const labelRect = activeLabel.getBoundingClientRect();

                handle.style.left = `${labelRect.left - switchRect.left}px`;
                handle.style.width = `${labelRect.width}px`;
            }

            switchElement.style.width = 'auto';
        }

        function switchTab(index) {
            const switchElement = document.getElementById('multiStateSwitch');
            const labels = switchElement.querySelectorAll('.switch-label');
            const activeStates = Array.from(labels).map(label => label.textContent);

            labels.forEach((label, i) => {
                label.classList.toggle('active', i === index);
            });

            updateSwitcherLayout();
            showContent(activeStates[index]);

            adjustLayout();
        }

        function showContent(state) {
            const tabContent = document.getElementById('tabContent');
            tabContent.innerHTML = stateContents[state] || '';

            if (state === 'Practice') {
                renderQuiz();
                updateProgressBar();
            }
        }

function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

function isTextEmpty(text) {
    return !text || text.trim() === "";
}

function renderQuiz() {
    const quizContainer = document.getElementById("quiz-content");
    quizContainer.innerHTML = '';

    // Only add stage text if it's not empty
    const stageText = quizData[0].stages[currentStage].text;
    if (!isTextEmpty(stageText)) {
        const stageTextElement = document.createElement("div");
        stageTextElement.className = "stage-text";
        stageTextElement.style.marginBottom = "20px";
        stageTextElement.style.padding = "15px";
        stageTextElement.style.backgroundColor = "#f5f5f5";
        stageTextElement.style.borderRadius = "5px";
        stageTextElement.textContent = stageText;
        quizContainer.appendChild(stageTextElement);
    }

    // Render questions
    quizData[0].stages[currentStage].questions.forEach((questionData, index) => {
        const questionElement = document.createElement("div");
        questionElement.className = "question-one-line";

        const label = document.createElement("label");
        label.htmlFor = `q${index}`;
        label.textContent = `${index + 1}. ${questionData.question}`;

        const resultDiv = document.createElement("div");
        resultDiv.className = "result result-ltr";
        resultDiv.id = `result${index}`;

        const select = document.createElement("select");
        select.id = `q${index}`;
        select.name = `q${index}`;

        const defaultOption = document.createElement("option");
        defaultOption.value = "";
        defaultOption.textContent = "Select";
        select.appendChild(defaultOption);

        const shuffledOptions = shuffleArray([...questionData.options]);
        shuffledOptions.forEach(option => {
            const optionElement = document.createElement("option");
            optionElement.value = option;
            optionElement.textContent = option;
            select.appendChild(optionElement);
        });

        questionElement.appendChild(label);
        questionElement.appendChild(resultDiv);
        questionElement.appendChild(select);

        quizContainer.appendChild(questionElement);
    });

    updateStageNumber();
}

function checkStage() {
    attempts++;
    document.getElementById("attempts").textContent = `Attempts: ${attempts}`;

    let correctCount = 0;
    const totalQuestions = quizData[0].stages[currentStage].questions.length;

    quizData[0].stages[currentStage].questions.forEach((questionData, index) => {
        const resultElement = document.getElementById(`result${index}`);
        const selectElement = document.getElementById(`q${index}`);
        const selectedAnswer = selectElement.value;

        if (selectedAnswer === questionData.answer) {
            resultElement.textContent = "Correct!";
            resultElement.style.color = "green";
            correctCount++;
        } else {
            resultElement.textContent = "Incorrect answer.";
            resultElement.style.color = "red";
        }

        if (attempts >= 10) {
            selectElement.value = questionData.answer;
            selectElement.disabled = true;
            resultElement.textContent += ` The correct answer is: ${questionData.answer}`;
        }
    });

    if (correctCount === totalQuestions) {
        console.log(`Stage ${currentStage + 1}: ${correctCount} correct out of ${totalQuestions}`);
        addAnimalsToFarm(totalQuestions);

        if (currentStage < quizData[0].stages.length - 1) {
            singleStageConfetti();
            showEncouragingPopup(correctCount, totalQuestions, true);
            currentStage++;
            updateProgressBar();
            setTimeout(() => {
                attempts = 0;
                renderQuiz();
                document.getElementById("attempts").textContent = `Attempts: ${attempts}`;
            }, 1500);
        } else {
            currentStage++;
            updateProgressBar();
            allStagesConfetti();
            showModal("Congratulations! You've completed all stages!");
        }
    } else {
        showEncouragingPopup(correctCount, totalQuestions, false);
        if (attempts >= 10) {
            showModal("You've reached the maximum number of attempts. The correct answers have been revealed.");
        }
    }

    scrollToTop();
}

// 4. Update stageCount calculation to work with new structure


		function showEncouragingPopup(correctCount, totalQuestions, isStageComplete) {
			const incorrectCount = totalQuestions - correctCount;
			let message = `You got ${correctCount} correct and ${incorrectCount} incorrect.`;

			// Add encouraging message based on performance
			if (correctCount === totalQuestions) {
				message += " Perfect score!";
			} else if (correctCount >= Math.ceil(totalQuestions * 0.7)) {
				message += " Great job! You're really getting the hang of this!";
			} else if (correctCount >= Math.ceil(totalQuestions * 0.5)) {
				message += " Good effort! Keep practicing and you'll improve in no time!";
			} else {
				message += " Don't give up! Every attempt helps you learn. Try again!";
			}

			// Add stage completion message if applicable
			if (isStageComplete) {
				message += "\n\n You've completed this stage. Moving to the next stage.";
			}

			showModal(message);
		}

		function initializeQuiz() {
			currentStage = 0;
			attempts = 0;
			updateProgressBar(); // This should now set the progress to 0%
			renderQuiz();
			document.getElementById("attempts").textContent = `Attempts: ${attempts}`;
			updateStageNumber();
		}

function updateProgressBar() {
    const progressBar = document.getElementById("progress-bar");
    const completedStages = currentStage;
    const progress = (completedStages / stageCount) * 100;
    const roundedProgress = Math.min(100, Math.max(0, Math.round(progress)));
    progressBar.style.width = `${roundedProgress}%`;
    progressBar.textContent = roundedProgress > 0 ? `${roundedProgress}%` : '';
    console.log(`Progress updated: ${roundedProgress}% (Stage ${currentStage + 1} of ${stageCount})`);
}

function updateStageNumber() {
    const stageElement = document.getElementById("stage-number");
    stageElement.textContent = `Stage ${currentStage + 1} of ${stageCount}`;
}

		function singleStageConfetti() {
			function randomInRange(min, max) {
				return Math.random() * (max - min) + min;
			}
			confetti({
				angle: randomInRange(55, 125),
				spread: randomInRange(50, 70),
				particleCount: randomInRange(50, 100),
				origin: { y: 0.6 },
			});
		}

		function allStagesConfetti() {
			const defaults = {
				spread: 360,
				ticks: 50,
				gravity: 0,
				decay: 0.94,
				startVelocity: 30,
				shapes: ["star"],
				colors: ["FFE400", "FFBD00", "E89400", "FFCA6C", "FDFFB8"],
			};
			function shoot() {
				confetti({
					...defaults,
					particleCount: 40,
					scalar: 1.2,
					shapes: ["star"],
				});
				confetti({
					...defaults,
					particleCount: 10,
					scalar: 0.75,
					shapes: ["circle"],
				});
			}
			setTimeout(shoot, 0);
			setTimeout(shoot, 100);
			setTimeout(shoot, 200);
		}

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
			    scrollToTopBtn.style.display = "none";
        }

        function initializeSwitch() {
            const switchElement = document.getElementById('multiStateSwitch');
            const labelsContainer = switchElement.querySelector('.switch-labels');
            const switchContainer = document.getElementById('switchContainer');

            const activeStates = Object.keys(stateContents).filter(state => stateContents[state].trim() !== '');

            if (activeStates.length <= 1) {
                switchContainer.style.display = 'none';
                if (activeStates.length === 1) {
                    showContent(activeStates[0]);
                }
                return;
            }

            switchContainer.style.display = 'flex';

            activeStates.forEach((state, index) => {
                const label = document.createElement('div');
                label.className = 'switch-label';
                label.textContent = state;
                label.addEventListener('click', () => switchTab(index));
                labelsContainer.appendChild(label);
            });

            const defaultTab = manuallySetDefaultTab !== null && manuallySetDefaultTab < activeStates.length
                ? manuallySetDefaultTab
                : 0;

            switchTab(defaultTab);
        }

		let farmAnimals = [];

		function addAnimalsToFarm(count) {
			const animalFarm = document.getElementById('animalFarm');
			let availableAnimals = animals.filter(animal => !farmAnimals.includes(animal));

			console.log(`Adding ${count} animals to the farm. Current farm size: ${farmAnimals.length}`);

			for (let i = 0; i < count; i++) {
				if (availableAnimals.length === 0) {
					console.log("No more unique animals available!");
					break;
				}

				const randomIndex = Math.floor(Math.random() * availableAnimals.length);
				const chosenAnimal = availableAnimals[randomIndex];

				const animalElement = document.createElement('li');
				animalElement.textContent = chosenAnimal;
				animalFarm.appendChild(animalElement);

				farmAnimals.push(chosenAnimal);
				availableAnimals.splice(randomIndex, 1);
				console.log(`Added animal: ${chosenAnimal}`);
			}

			console.log(`Farm size after addition: ${farmAnimals.length}`);
			logAnimalFarmState();
		}

		function logAnimalFarmState() {
			console.log(`Current animal farm state: ${farmAnimals.length} animals`);
			console.log(farmAnimals);
		}

		const animals = [
			"🐉", "🐻", "🦗", "🦁", "🐔", "🦂", "🐟", "🐣", "🐯", "🦡",
			"🐰", "🐍", "🦅", "🐈", "🦈", "🦜", "🦛", "🐀", "🐑",
			"🐮", "🦇", "🐇", "🦖", "🦀", "🦎", "🐃", "🐡", "🐤",
			"🐪", "🦥", "🐛", "🐅", "🐥", "🐱", "🐺", "🐕", "🦩", "🐊",
			"🐖", "🐢", "🕷", "🦕", "🦌", "🐁", "🦨", "🦘", "🐵",
			"🦑", "🐋", "🦓", "🦒", "🐲", "🦆", "🦉", "🐶", "🐄", "🦟",
			"🦃", "🦧", "🦏", "🐙", "🐿", "🦢", "🐜", "🐦", "🐞",
			"🦐", "🦔", "🐼", "🦄", "🦞", "🐫", "🐭", "🐆", "🦝",
			"🐠", "🦚", "🐴", "🐏", "🦮", "🐐", "🐹", "🐎", "🦋", "🐳",
			"🐨", "🐂", "🦍", "🦙", "🐬", "🦦", "🦊", "🐌", "🐓", "🐧",
			"🐷", "🐩", "🐘", "🐸", "🐝"
		];

        function showModal(message) {
            const modal = document.getElementById("quizModal");
            const modalMessage = document.getElementById("modalMessage");
            const modalButton = document.getElementById("modalButton");
            const modalClose = document.getElementsByClassName("modal-quiz-close")[0];

            modalMessage.textContent = message;
            modal.style.display = "block";

            modalButton.onclick = function() {
                modal.style.display = "none";
            }

            modalClose.onclick = function() {
                modal.style.display = "none";
            }

            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }
        }

		window.addEventListener('load', () => {
			initializeSwitch();
			initializeQuiz();
			adjustLayout();
        });

        window.addEventListener('resize', adjustLayout);

        // Load the copyright content from the external URL and insert it into the div
        fetch('http://ez42.live/global/copyright.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('copyright-container').innerHTML = data;
            })
            .catch(error => console.error('Error loading copyright:', error));

		let scrollToTopBtn = document.getElementById("scrollToTopBtn");

			window.onscroll = function() {
				// Check if the scroll distance is more than twice the height of the screen
				if (document.body.scrollTop > window.innerHeight * 1.5 ||
					document.documentElement.scrollTop > window.innerHeight * 1.5) {
					scrollToTopBtn.style.display = "block";
				} else {
					scrollToTopBtn.style.display = "none";
				}
			};

		scrollToTopBtn.onclick = function() {
		  document.body.scrollTop = 0;
		  document.documentElement.scrollTop = 0;
		};
    </script>
</body>
</html>