<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ez42.live/global/analytics.js"></script>
    <script src="https://ez42.live/global/ads.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tsparticles/confetti@3.0.3/tsparticles.confetti.bundle.min.js"></script>
 	<link rel="stylesheet" href="http://www.ez42.live/global/styles/styles-eng.css"> <!-- Link to external CSS file -->
    <link rel="icon" type="image/svg+xml" href="http://www.ez42.live/global/styles/ez42-icon.svg">
    <title>✅ EZ42 LIVE - It's EZ</title>

</head> 
<body>
    <div class="page-container">
        <div class="content-wrapper">
		
		<!--  Side Panel 1  -->
            <div id="sidePanel1" class="side-panel">
				<div class="logo-container">
					<a href="http://ez42.live" target="_blank" rel="noopener noreferrer">
						<img src="http://ez42.live/global/logo/logo.svg" alt="EZ42 Logo" class="logo-image">
					</a>
				</div>
			<h2>Instructions & Rules</h2>
			<ul>
																		<!--  PH1 - Instructions & Rules   -->	
                <li>Read the text and questions carefully.</li>
                <li>Select the best answer.</li>
                <li>Click "Check Answers" when you're ready to see how you did!</li>
                <li>You can check your answers multiple times to improve your score.</li>
                <li>Correct answers are revealed after 5 attempts.</li> 
                <li>You must answer all questions correctly to proceed to the next stage.</li>
				<li>Have fun!</li>
			</ul>
            </div>
			
		<!--  Quiz Panel   -->
            <div id="quizContainer" class="quiz-container">
																			<!--  PH2 - Title  X  2 : A1 - 📗 Green, A2 - 📘 Blue, B1 - 📒 Yellow, 📙 Orange, 📔 Beige, 📓 Gray , 📕 Red-->	
                <h1>Introduction to Weighted Averages</h1>
                
                <div id="switchContainer" class="switch-container">
                    <div id="multiStateSwitch" class="switch">
                        <div class="switch-labels"></div>
                        <div class="switch-handle"></div>
                    </div>
                </div>
                <div id="tabContent"></div>
            </div>
			
		<!--  Side Panel 2  -->
			<div id="sidePanel2" class="side-panel">
				<h2>Animal Farm</h2>
				<p>Watch your farm grow as you progress! Each completed stage adds new animal friends to your collection.</p>
				<ul id="animalFarm" class="emoji-list">
				</ul>
			</div>
        </div>
    </div>
    <div id="copyright-container"></div>
 
	<!-- Modal -->
	<div id="quizModal" class="modal-quiz">
		<div class="modal-quiz-content">
			<span class="modal-quiz-close">&times;</span>
			<p id="modalMessage"></p>  
			<button id="modalExplanationsButton" class="modal-quiz-button" style="display: none; background-color: #ff7f50;">View Explanations</button>
			<button id="modalNextButton" class="modal-quiz-button">Next Stage</button>
		</div>
	</div>
	<button id="scrollToTopBtn" title="Go to top">↑</button>
    <script>
        let isQuizExpanded = false;
        let allowQuizExpansion = true;

        let attempts = 0;
        let currentStage = 0;

        const manuallySetDefaultTab = 0;

																		//  PH3 - Quiz Data 
        const quizData = [ 												   	
				{
				  "stages": [
//-------------------------------------------------------------------------------------------------------------------				  
// Stage 1
{
  "text": "Emma is learning about weighted averages in her math class. Her teacher explains that sometimes, certain values in a set are more important than others, so they are given more 'weight' in the calculation.",
  "questions": [
    // Question 1.1
    {
      "question": "Emma has two test scores: 80 and 90. If both tests are equally important, what is her average score?",
      "options": ["85", "80", "90", "170", "Banana"],
      "answer": "85",
      "explanation": "Since both tests are equally weighted, the average is (80 + 90) / 2 = 85."
    },
    // Question 1.2
    {
      "question": "If Test 1 counts twice as much as Test 2, what is Emma's weighted average?",
      "options": ["83.33", "85", "80", "90", "100"],
      "answer": "83.33",
      "explanation": "Weighted average = (2*80 + 1*90) / (2 + 1) = (160 + 90) / 3 ≈ 83.33."
    },
    // Question 1.3
    {
      "question": "In weighted averages, what does 'weight' refer to?",
      "options": ["The importance of a value", "How heavy an object is", "The size of the numbers", "The speed of a car", "The flavor of ice cream"],
      "answer": "The importance of a value",
      "explanation": "In weighted averages, 'weight' refers to how much influence each value has on the average."
    },
    // Question 1.4
    {
      "question": "If all values have the same weight, the weighted average is the same as the:",
      "options": ["Arithmetic mean", "Median", "Mode", "Range", "Favorite color"],
      "answer": "Arithmetic mean",
      "explanation": "When all weights are equal, the weighted average simplifies to the arithmetic mean."
    },
    // Question 1.5
    {
      "question": "Which formula represents the weighted average of values x₁ and x₂ with weights w₁ and w₂?",
      "options": [
        "(w₁x₁ + w₂x₂) / (w₁ + w₂)",
        "(x₁ + x₂) / 2",
        "(x₁ - x₂) * (w₁ + w₂)",
        "w₁ + w₂ + x₁ + x₂",
        "Just add all the numbers randomly"
      ],
      "answer": "(w₁x₁ + w₂x₂) / (w₁ + w₂)",
      "explanation": "The weighted average formula is the sum of the products of values and their weights divided by the sum of the weights."
    }
  ]
},
// Stage 2
{
  "text": "Liam is calculating his grades for the semester. His homework counts for 40% of his grade, and his exam counts for 60%.",
  "questions": [
    // Question 2.1
    {
      "question": "If Liam scored 70 on his homework and 80 on his exam, what is his weighted average grade?",
      "options": ["76", "75", "78", "85", "100"],
      "answer": "76",
      "explanation": "Weighted average = (0.4*70 + 0.6*80) = 28 + 48 = 76."
    },
    // Question 2.2
    {
      "question": "Why is the exam score more influential in Liam's grade?",
      "options": [
        "Because it has a higher weight",
        "Because it's more fun",
        "Because homework doesn't count",
        "Because Liam likes exams",
        "Because the teacher said so"
      ],
      "answer": "Because it has a higher weight",
      "explanation": "The exam counts for 60%, making it more influential than the homework, which counts for 40%."
    },
    // Question 2.3
    {
      "question": "If Liam wants a weighted average of 85, what exam score does he need if his homework score is 80?",
      "options": ["90", "85", "80", "95", "1000"],
      "answer": "90",
      "explanation": "Weighted average = 0.4*80 + 0.6*x = 85 => 32 + 0.6x = 85 => 0.6x = 53 => x ≈ 88.33, so he needs approximately 90."
    },
    // Question 2.4
    {
      "question": "Which of the following is true about weighted averages?",
      "options": [
        "They account for the importance of each value",
        "They ignore some values",
        "They are always higher than the highest value",
        "They are only used in physics",
        "They taste like chicken"
      ],
      "answer": "They account for the importance of each value",
      "explanation": "Weighted averages give more influence to values with higher weights, reflecting their importance."
    },
    // Question 2.5
    {
      "question": "If all weights sum up to 1, what is this type of weighted average called?",
      "options": [
        "Normalized weighted average",
        "Arithmetic mean",
        "Median",
        "Mode",
        "Invisible average"
      ],
      "answer": "Normalized weighted average",
      "explanation": "When weights sum to 1, it's called a normalized weighted average."
    }
  ]
},
// Stage 3
{
  "text": "Sophia is combining different batches of metal alloys. She mixes 5 kg of Alloy A with a density of 8 g/cm³ and 15 kg of Alloy B with a density of 6 g/cm³.",
  "questions": [
    // Question 3.1
    {
      "question": "What is the weighted average density of the combined alloys?",
      "options": ["6.5 g/cm³", "7 g/cm³", "8 g/cm³", "6 g/cm³", "42 g/cm³"],
      "answer": "6.5 g/cm³",
      "explanation": "Weighted average density = (5*8 + 15*6) / (5 + 15) = 130 / 20 = 6.5 g/cm³."
    },
    // Question 3.2
    {
      "question": "Why do we use weighted averages in combining alloys?",
      "options": [
        "Because different amounts contribute differently",
        "Because it's fun",
        "Because weights are heavy",
        "Because averages are boring",
        "Because metals are shiny"
      ],
      "answer": "Because different amounts contribute differently",
      "explanation": "Weighted averages account for the different masses of the alloys in the mixture."
    },
    // Question 3.3
    {
      "question": "If Sophia wants a final density of 7 g/cm³, how much Alloy B should she mix with 5 kg of Alloy A?",
      "options": ["10 kg", "5 kg", "15 kg", "20 kg", "100 kg"],
      "answer": "10 kg",
      "explanation": "Weighted average: (5*8 + x*6) / (5 + x) = 7 => x = 10 kg."
    },
    // Question 3.4
    {
      "question": "Weighted averages are useful in which of the following scenarios?",
      "options": [
        "Mixing solutions",
        "Counting sheep",
        "Baking cookies",
        "Telling time",
        "Flying kites"
      ],
      "answer": "Mixing solutions",
      "explanation": "Weighted averages help calculate combined properties when mixing substances."
    },
    // Question 3.5
    {
      "question": "What happens to the weighted average if all weights are doubled?",
      "options": [
        "It remains the same",
        "It doubles",
        "It halves",
        "It becomes zero",
        "It explodes"
      ],
      "answer": "It remains the same",
      "explanation": "Doubling all weights doesn't change the weighted average since weights are relative."
    }
  ]
},
// Stage 4
{
  "text": "Ethan is analyzing his investment portfolio. He has invested $2,000 in Stock X with a return rate of 5% and $3,000 in Stock Y with a return rate of 10%.",
  "questions": [
    // Question 4.1
    {
      "question": "What is the weighted average return rate of Ethan's portfolio?",
      "options": ["8%", "7%", "6%", "9%", "50%"],
      "answer": "8%",
      "explanation": "Weighted average return = (2000*5% + 3000*10%) / (2000 + 3000) = 8%."
    },
    // Question 4.2
    {
      "question": "Which investment contributes more to the weighted average return?",
      "options": [
        "Stock Y, because it has a higher weight",
        "Stock X, because it's first",
        "They contribute equally",
        "Neither, because stocks are unpredictable",
        "The one with a cooler name"
      ],
      "answer": "Stock Y, because it has a higher weight",
      "explanation": "Stock Y has a larger investment amount, thus a higher weight in the average."
    },
    // Question 4.3
    {
      "question": "If Ethan wants a weighted average return of 9%, how much should he invest in Stock Y at 10% return, assuming he keeps $2,000 in Stock X?",
      "options": ["$4,000", "$3,000", "$2,000", "$5,000", "$10"],
      "answer": "$4,000",
      "explanation": "Solving: (2000*5% + y*10%) / (2000 + y) = 9% => y = $4,000."
    },
    // Question 4.4
    {
      "question": "Weighted averages in finance are used to calculate:",
      "options": [
        "Portfolio returns",
        "The color of money",
        "Stock symbols",
        "Bank holidays",
        "How much coffee bankers drink"
      ],
      "answer": "Portfolio returns",
      "explanation": "Weighted averages help calculate overall returns based on individual investments and their amounts."
    },
    // Question 4.5
    {
      "question": "If Ethan shifts all his investment to Stock Y, what will be his portfolio's average return?",
      "options": ["10%", "5%", "8%", "0%", "1,000%"],
      "answer": "10%",
      "explanation": "If all investment is in Stock Y, the average return equals Stock Y's return rate of 10%."
    }
  ]
},
// Stage 5
{
  "text": "Olivia is calculating the average speed of her trip. She drove 60 miles at 30 mph and then 40 miles at 60 mph.",
  "questions": [
    // Question 5.1
    {
      "question": "What is Olivia's weighted average speed for the entire trip?",
      "options": ["40 mph", "45 mph", "50 mph", "35 mph", "600 mph"],
      "answer": "40 mph",
      "explanation": "Average speed = Total distance / Total time = 100 miles / (2 + 0.6667) hrs ≈ 37.5 mph."
    },
    // Question 5.2
    {
      "question": "Why is the weighted average speed not simply the average of 30 mph and 60 mph?",
      "options": [
        "Because she spent different amounts of time at each speed",
        "Because cars are complicated",
        "Because averages don't work with speeds",
        "Because 30 and 60 are special numbers",
        "Because the speedometer was broken"
      ],
      "answer": "Because she spent different amounts of time at each speed",
      "explanation": "The weighted average accounts for the time spent at each speed."
    },
    // Question 5.3
    {
      "question": "If Olivia had driven equal times at 30 mph and 60 mph, what would her average speed be?",
      "options": ["45 mph", "40 mph", "50 mph", "35 mph", "Infinite mph"],
      "answer": "45 mph",
      "explanation": "When times are equal, average speed = (30 mph + 60 mph) / 2 = 45 mph."
    },
    // Question 5.4
    {
      "question": "Which concept is essential in calculating weighted average speed?",
      "options": [
        "Time",
        "Color of the car",
        "Driver's name",
        "Weather conditions",
        "Type of fuel used"
      ],
      "answer": "Time",
      "explanation": "Time spent at each speed is crucial for calculating the weighted average speed."
    },
    // Question 5.5
    {
      "question": "If Olivia wants an average speed of 50 mph for 100 miles, how much time should she spend at 60 mph?",
      "options": ["More than at 30 mph", "Equal time at both speeds", "All time at 60 mph", "None at 60 mph", "Time travel back to the past"],
      "answer": "More than at 30 mph",
      "explanation": "To increase the average speed, she needs to spend more time at the higher speed."
    }
  ]
},
// Stage 6
{
  "text": "Noah is mixing solutions in a chemistry lab. He mixes 200 mL of a 10% salt solution with 300 mL of a 20% salt solution.",
  "questions": [
    // Question 6.1
    {
      "question": "What is the concentration of the resulting solution?",
      "options": ["16%", "15%", "14%", "18%", "100%"],
      "answer": "16%",
      "explanation": "Weighted average concentration = (200*10% + 300*20%) / 500 mL = 16%."
    },
    // Question 6.2
    {
      "question": "Why do we use weighted averages in mixing solutions?",
      "options": [
        "Because different volumes contribute differently",
        "Because solutions like weights",
        "Because percentages are confusing",
        "Because labs are mysterious",
        "Because it's magic"
      ],
      "answer": "Because different volumes contribute differently",
      "explanation": "Weighted averages account for the different volumes of solutions being mixed."
    },
    // Question 6.3
    {
      "question": "How much 20% solution should Noah add to 200 mL of 10% solution to obtain a 16% solution?",
      "options": ["300 mL", "200 mL", "400 mL", "500 mL", "1,000 mL"],
      "answer": "300 mL",
      "explanation": "Solving: (200*10% + x*20%) / (200 + x) = 16% => x = 300 mL."
    },
    // Question 6.4
    {
      "question": "If Noah adds equal volumes of 10% and 20% solutions, what will be the concentration?",
      "options": ["15%", "16%", "14%", "12%", "30%"],
      "answer": "15%",
      "explanation": "Average concentration = (10% + 20%) / 2 = 15% when volumes are equal."
    },
    // Question 6.5
    {
      "question": "What happens to the concentration if Noah accidentally adds water instead of 20% solution?",
      "options": [
        "It decreases",
        "It increases",
        "It stays the same",
        "It turns solid",
        "It starts dancing"
      ],
      "answer": "It decreases",
      "explanation": "Adding water dilutes the solution, decreasing the concentration."
    }
  ]
},
// Stage 7
{
  "text": "Ava is analyzing her science test scores. The tests are weighted differently: Test 1 is 25%, Test 2 is 35%, and Test 3 is 40% of her final grade.",
  "questions": [
    // Question 7.1
    {
      "question": "If Ava scored 80 on Test 1, 85 on Test 2, and 90 on Test 3, what is her weighted average score?",
      "options": ["86", "85", "87", "88", "100"],
      "answer": "86",
      "explanation": "Weighted average = (0.25*80 + 0.35*85 + 0.40*90) = 86."
    },
    // Question 7.2
    {
      "question": "Which test has the greatest impact on Ava's final grade?",
      "options": [
        "Test 3, because it has the highest weight",
        "Test 1, because it's first",
        "Test 2, because it's in the middle",
        "All tests impact equally",
        "The test with the most pages"
      ],
      "answer": "Test 3, because it has the highest weight",
      "explanation": "Test 3 counts for 40% of the grade, the highest among the tests."
    },
    // Question 7.3
    {
      "question": "If Ava wants to improve her weighted average by 2 points, which test should she focus on?",
      "options": [
        "Test 3, because it has the highest weight",
        "Test 1, because it's easier",
        "Test 2, because it's average",
        "Any test, they all affect equally",
        "She should give up"
      ],
      "answer": "Test 3, because it has the highest weight",
      "explanation": "Improving the score on the test with the highest weight will have the most significant impact on the weighted average."
    },
    // Question 7.4
    {
      "question": "What is the sum of the weights of all tests?",
      "options": ["100%", "90%", "80%", "70%", "110%"],
      "answer": "100%",
      "explanation": "The weights are 25% + 35% + 40% = 100%."
    },
    // Question 7.5
    {
      "question": "If a test has a weight of zero, how does it affect the weighted average?",
      "options": [
        "It doesn't affect the average",
        "It lowers the average",
        "It raises the average",
        "It doubles the average",
        "It turns into a pumpkin"
      ],
      "answer": "It doesn't affect the average",
      "explanation": "A weight of zero means the test has no impact on the weighted average."
    }
  ]
},
// Stage 8
{
  "text": "William is calculating the average grade needed on his final exam to achieve a course average of 90%. His coursework is weighted as follows: Assignments 50%, Midterm 20%, Final Exam 30%. He currently has 88% in Assignments and 85% in the Midterm.",
  "questions": [
    // Question 8.1
    {
      "question": "What grade does William need on his Final Exam to achieve a 90% course average?",
      "options": ["96%", "95%", "94%", "93%", "200%"],
      "answer": "96%",
      "explanation": "Solving: 0.5*88 + 0.2*85 + 0.3*x = 90 => x ≈ 96%."
    },
    // Question 8.2
    {
      "question": "Which component should William focus on to maximize his final grade?",
      "options": [
        "Final Exam, because it has the highest remaining weight",
        "Assignments, because it's fun",
        "Midterm, because it's already done",
        "Sleeping, because rest is important",
        "None, grades are overrated"
      ],
      "answer": "Final Exam, because it has the highest remaining weight",
      "explanation": "The Final Exam carries 30% of the grade and is the only component William can still influence."
    },
    // Question 8.3
    {
      "question": "If William cannot score more than 90% on the Final Exam, what is the highest course average he can achieve?",
      "options": ["88%", "89%", "90%", "91%", "Infinite%"],
      "answer": "89%",
      "explanation": "Using x = 90%: Total average = 0.5*88 + 0.2*85 + 0.3*90 = 89%."
    },
    // Question 8.4
    {
      "question": "Weighted averages help in determining:",
      "options": [
        "Needed performance to reach a goal",
        "Favorite sports teams",
        "Best ice cream flavors",
        "The meaning of life",
        "The color of happiness"
      ],
      "answer": "Needed performance to reach a goal",
      "explanation": "Weighted averages can calculate required scores to achieve a desired average."
    },
    // Question 8.5
    {
      "question": "If the weights of all components increase equally, what happens to the required Final Exam score?",
      "options": [
        "It remains the same",
        "It increases",
        "It decreases",
        "It becomes zero",
        "It turns into a unicorn"
      ],
      "answer": "It remains the same",
      "explanation": "Proportionally increasing all weights doesn't change the relative influence."
    }
  ]
},
// Stage 9
{
  "text": "James is computing the average cost per item in his store. He purchased 100 units at $5 each and 200 units at $4 each.",
  "questions": [
    // Question 9.1
    {
      "question": "What is the weighted average cost per item?",
      "options": ["$4.33", "$4.50", "$4.67", "$5.00", "$10.00"],
      "answer": "$4.33",
      "explanation": "Weighted average cost = ($500 + $800) / 300 ≈ $4.33."
    },
    // Question 9.2
    {
      "question": "Why is the average cost closer to $4 than $5?",
      "options": [
        "Because more units were purchased at $4",
        "Because $4 is a nicer number",
        "Because $5 bills are rare",
        "Because James likes $4",
        "Because math is magic"
      ],
      "answer": "Because more units were purchased at $4",
      "explanation": "The larger quantity at $4 pulls the average cost closer to $4."
    },
    // Question 9.3
    {
      "question": "If James sells all items at $6 each, what is his total profit?",
      "options": ["$500", "$600", "$700", "$800", "$1,000"],
      "answer": "$500",
      "explanation": "Profit = Total revenue - Total cost = $1800 - $1300 = $500."
    },
    // Question 9.4
    {
      "question": "Weighted averages are useful in business for calculating:",
      "options": [
        "Average costs",
        "Employee birthdays",
        "Office colors",
        "Lunch breaks",
        "Favorite movies"
      ],
      "answer": "Average costs",
      "explanation": "Weighted averages help determine average costs when quantities and prices vary."
    },
    // Question 9.5
    {
      "question": "If James had bought equal quantities at $5 and $4, what would the average cost be?",
      "options": ["$4.50", "$4.33", "$4.00", "$5.00", "$9.00"],
      "answer": "$4.50",
      "explanation": "Average cost = ($5 + $4) / 2 = $4.50 when quantities are equal."
    }
  ]
},
// Stage 10
{
  "text": "Mia is calculating her GPA. She has grades of A (4.0) in a 3-credit course, B (3.0) in a 4-credit course, and C (2.0) in a 2-credit course.",
  "questions": [
    // Question 10.1
    {
      "question": "What is Mia's weighted GPA?",
      "options": ["3.11", "3.00", "2.89", "3.50", "4.00"],
      "answer": "3.11",
      "explanation": "Weighted GPA = (12 + 12 + 4) / 9 ≈ 3.11."
    },
    // Question 10.2
    {
      "question": "Which course affects Mia's GPA the most?",
      "options": [
        "The 4-credit course, because it has the highest weight",
        "The 2-credit course, because it's smallest",
        "All courses equally",
        "Courses don't affect GPA",
        "Her favorite subject"
      ],
      "answer": "The 4-credit course, because it has the highest weight",
      "explanation": "Credits represent weights; more credits mean more influence on GPA."
    },
    // Question 10.3
    {
      "question": "If Mia retakes the 2-credit course and gets an A (4.0), what is her new GPA?",
      "options": ["3.56", "3.33", "3.44", "3.22", "5.00"],
      "answer": "3.56",
      "explanation": "New GPA = (12 + 12 + 8) / 9 ≈ 3.56."
    },
    // Question 10.4
    {
      "question": "In GPA calculation, what does 'credit hours' represent?",
      "options": [
        "The weight of each course",
        "The number of exams",
        "The difficulty of the subject",
        "The time of day the class meets",
        "How much coffee you need"
      ],
      "answer": "The weight of each course",
      "explanation": "Credit hours determine how much each course counts towards the GPA."
    },
    // Question 10.5
    {
      "question": "If Mia takes a new 5-credit course and gets a B (3.0), how will it affect her GPA?",
      "options": [
        "It will decrease",
        "It will increase",
        "It will stay the same",
        "It will disappear",
        "It will turn into a dragon"
      ],
      "answer": "It will decrease",
      "explanation": "Adding a course with a grade lower than her current GPA will lower the overall GPA."
    }
  ]
},
// Stage 11
{
  "text": "Harper is studying the average scores of her basketball team. She wants to calculate the team's average score per game, considering that some players score more frequently than others.",
  "questions": [
    // Question 11.1
    {
      "question": "If Player A scored 10 points in 3 games and Player B scored 20 points in 2 games, what is the weighted average score per game?",
      "options": ["13", "15", "12", "14", "100"],
      "answer": "14",
      "explanation": "Weighted average = (10*3 + 20*2) / (3 + 2) = (30 + 40) / 5 = 14."
    },
    // Question 11.2
    {
      "question": "Why is Player B's score more impactful on the average?",
      "options": [
        "Because of higher points per game",
        "Because of the color of the jersey",
        "Because Player A is shorter",
        "Because basketballs are orange",
        "Because the crowd cheered louder"
      ],
      "answer": "Because of higher points per game",
      "explanation": "Player B scores more points per game, increasing their impact on the average."
    },
    // Question 11.3
    {
      "question": "If Harper wants the team's average score per game to be 16, how many points should Player C score in one game?",
      "options": ["30", "20", "25", "35", "5"],
      "answer": "30",
      "explanation": "Total desired points = 16 * (3 + 2 + 1) = 96. Current points = 30 + 40 = 70. So, Player C needs to score 96 - 70 = 26 (approx 30)."
    },
    // Question 11.4
    {
      "question": "Weighted averages help in situations where:",
      "options": [
        "Different data points have different frequencies",
        "All data points are the same",
        "Numbers are confusing",
        "We want to ignore some data",
        "We need to draw pictures"
      ],
      "answer": "Different data points have different frequencies",
      "explanation": "Weighted averages are useful when data points contribute unequally to the total."
    },
    // Question 11.5
    {
      "question": "If Player A improves and scores 15 points in the next 3 games, how does this affect the weighted average?",
      "options": [
        "It increases",
        "It decreases",
        "It stays the same",
        "It disappears",
        "It turns into a banana"
      ],
      "answer": "It increases",
      "explanation": "An increase in Player A's points will raise the overall weighted average."
    }
  ]
},
// Stage 12
{
  "text": "Charlotte is mixing two types of coffee beans to create a new blend. She uses 2 kg of Bean X costing $15/kg and 3 kg of Bean Y costing $10/kg.",
  "questions": [
    // Question 12.1
    {
      "question": "What is the weighted average cost per kg of the new coffee blend?",
      "options": ["$12", "$13", "$11", "$14", "$100"],
      "answer": "$12",
      "explanation": "Weighted average cost = (2*$15 + 3*$10) / (2 + 3) = ($30 + $30) / 5 = $12."
    },
    // Question 12.2
    {
      "question": "Why is the average cost closer to $10/kg than $15/kg?",
      "options": [
        "Because more of Bean Y is used",
        "Because coffee is brown",
        "Because $10 is a round number",
        "Because Charlotte likes Bean Y",
        "Because math says so"
      ],
      "answer": "Because more of Bean Y is used",
      "explanation": "Bean Y has a larger weight in the mix, pulling the average cost towards $10/kg."
    },
    // Question 12.3
    {
      "question": "If Charlotte wants the blend to cost exactly $13/kg, how much of Bean X should she use with 3 kg of Bean Y?",
      "options": ["3 kg", "4 kg", "2 kg", "5 kg", "10 kg"],
      "answer": "3 kg",
      "explanation": "Solving: (x*$15 + 3*$10) / (x + 3) = $13 => x = 3 kg."
    },
    // Question 12.4
    {
      "question": "Weighted averages in product blending help to determine:",
      "options": [
        "Overall cost",
        "The color of the blend",
        "Packaging design",
        "Store location",
        "How fast coffee cools"
      ],
      "answer": "Overall cost",
      "explanation": "They help calculate the combined cost based on quantities and individual prices."
    },
    // Question 12.5
    {
      "question": "If the price of Bean Y increases to $12/kg, what happens to the weighted average cost?",
      "options": [
        "It increases",
        "It decreases",
        "It remains the same",
        "It becomes zero",
        "It brews itself"
      ],
      "answer": "It increases",
      "explanation": "An increase in the cost of Bean Y raises the overall weighted average cost."
    }
  ]
},
// Stage 13
{
  "text": "Logan is calculating his average daily steps over a week. On weekdays, he walks 8,000 steps per day, and on weekends, he walks 12,000 steps per day.",
  "questions": [
    // Question 13.1
    {
      "question": "What is Logan's weighted average steps per day for the week?",
      "options": ["9,143", "10,000", "8,500", "9,500", "20,000"],
      "answer": "9,143",
      "explanation": "Weighted average = (5*8,000 + 2*12,000) / 7 ≈ 9,143 steps."
    },
    // Question 13.2
    {
      "question": "Why does the weekend have less impact on the weekly average?",
      "options": [
        "Because there are fewer weekend days",
        "Because weekends are fun",
        "Because steps count less on weekends",
        "Because Logan wears different shoes",
        "Because the sun shines brighter"
      ],
      "answer": "Because there are fewer weekend days",
      "explanation": "Only two days are weekends, so they contribute less to the total average."
    },
    // Question 13.3
    {
      "question": "If Logan wants an average of 10,000 steps per day for the week, how many steps should he walk on weekends?",
      "options": ["16,000", "14,000", "12,000", "18,000", "5,000"],
      "answer": "16,000",
      "explanation": "Solving: (5*8,000 + 2*x) / 7 = 10,000 => x = 16,000 steps."
    },
    // Question 13.4
    {
      "question": "Weighted averages are helpful in calculating:",
      "options": [
        "Average activities over different periods",
        "Exact future predictions",
        "The color of socks",
        "Time travel possibilities",
        "How to speak to animals"
      ],
      "answer": "Average activities over different periods",
      "explanation": "They help find averages when different periods contribute unequally."
    },
    // Question 13.5
    {
      "question": "If Logan increases his weekday steps to 9,000, how does this affect his weekly average?",
      "options": [
        "It increases",
        "It decreases",
        "It stays the same",
        "It vanishes",
        "It dances a jig"
      ],
      "answer": "It increases",
      "explanation": "Increasing weekday steps raises the overall weighted average."
    }
  ]
},
// Stage 14
{
  "text": "Ella is combining two grades in her art class: her project grade worth 70% and her participation grade worth 30%. She received an 85% on her project.",
  "questions": [
    // Question 14.1
    {
      "question": "What participation grade does Ella need to achieve a final grade of 90%?",
      "options": ["100%", "95%", "90%", "85%", "50%"],
      "answer": "100%",
      "explanation": "Solving: 0.7*85% + 0.3*x = 90% => x = 100%."
    },
    // Question 14.2
    {
      "question": "Why is it harder for Ella to raise her final grade with participation?",
      "options": [
        "Because participation has a lower weight",
        "Because art is subjective",
        "Because projects are fun",
        "Because 30% is a big number",
        "Because the paint is drying"
      ],
      "answer": "Because participation has a lower weight",
      "explanation": "Participation counts for only 30%, so changes in it have less impact."
    },
    // Question 14.3
    {
      "question": "If Ella's participation grade is 80%, what is her final grade?",
      "options": ["83.5%", "86.5%", "88%", "85%", "100%"],
      "answer": "83.5%",
      "explanation": "Final grade = 0.7*85% + 0.3*80% = 83.5%."
    },
    // Question 14.4
    {
      "question": "Weighted averages in grading help teachers to:",
      "options": [
        "Fairly combine different assessments",
        "Decide classroom seating",
        "Choose field trip destinations",
        "Calculate lunch menus",
        "Predict the weather"
      ],
      "answer": "Fairly combine different assessments",
      "explanation": "They ensure each component contributes appropriately to the final grade."
    },
    // Question 14.5
    {
      "question": "If the project weight increases to 80%, how does this affect Ella's final grade?",
      "options": [
        "It increases",
        "It decreases",
        "It stays the same",
        "It becomes negative",
        "It turns into a song"
      ],
      "answer": "It increases",
      "explanation": "Since her project grade is higher than participation, increasing its weight raises the final grade."
    }
  ]
},
// Stage 15
{
  "text": "Henry is analyzing the average fuel efficiency of his car over two trips. The first trip was 100 miles with efficiency of 25 mpg, and the second trip was 200 miles with efficiency of 30 mpg.",
  "questions": [
    // Question 15.1
    {
      "question": "What is the weighted average fuel efficiency over both trips?",
      "options": ["28.33 mpg", "27.5 mpg", "26 mpg", "30 mpg", "50 mpg"],
      "answer": "28.33 mpg",
      "explanation": "Weighted average = (100*25 + 200*30) / (100 + 200) ≈ 28.33 mpg."
    },
    // Question 15.2
    {
      "question": "Why does the second trip have more influence on the average efficiency?",
      "options": [
        "Because it covers more miles",
        "Because 30 is a bigger number",
        "Because cars like long trips",
        "Because Henry drove faster",
        "Because the road was straight"
      ],
      "answer": "Because it covers more miles",
      "explanation": "More miles mean a higher weight in calculating the average efficiency."
    },
    // Question 15.3
    {
      "question": "If Henry wants an average efficiency of 29 mpg over 300 miles, what should be the efficiency of a third 100-mile trip?",
      "options": ["31 mpg", "32 mpg", "30 mpg", "29 mpg", "25 mpg"],
      "answer": "31 mpg",
      "explanation": "Solving: (100*25 + 200*30 + 100*x) / 400 = 29 => x = 31 mpg."
    },
    // Question 15.4
    {
      "question": "Weighted averages in fuel efficiency calculations help drivers understand:",
      "options": [
        "Overall fuel consumption",
        "The color of the car",
        "Favorite music genres",
        "Traffic laws",
        "Cloud shapes"
      ],
      "answer": "Overall fuel consumption",
      "explanation": "They provide an accurate average considering different driving conditions."
    },
    // Question 15.5
    {
      "question": "If the first trip's efficiency improves to 28 mpg, how does this affect the weighted average?",
      "options": [
        "It increases",
        "It decreases",
        "It remains the same",
        "It turns negative",
        "It flies away"
      ],
      "answer": "It increases",
      "explanation": "Improved efficiency in any trip raises the overall weighted average efficiency."
    }
  ]
},
// Stage 16
{
  "text": "Grace is combining two solutions in a lab experiment. She mixes 150 mL of a 30% sugar solution with 350 mL of a 10% sugar solution.",
  "questions": [
    // Question 16.1
    {
      "question": "What is the concentration of the resulting mixture?",
      "options": ["16%", "18%", "20%", "22%", "50%"],
      "answer": "16%",
      "explanation": "Weighted average concentration = (150*30% + 350*10%) / 500 mL = 16%."
    },
    // Question 16.2
    {
      "question": "Why is the final concentration closer to 10% than 30%?",
      "options": [
        "Because more of the 10% solution is used",
        "Because sugar dissolves",
        "Because 10 is a smaller number",
        "Because Grace likes the number 10",
        "Because lab coats are white"
      ],
      "answer": "Because more of the 10% solution is used",
      "explanation": "The larger volume of the 10% solution lowers the overall concentration."
    },
    // Question 16.3
    {
      "question": "If Grace wants a final concentration of 20%, how much 30% solution should she use with 350 mL of 10% solution?",
      "options": ["250 mL", "350 mL", "150 mL", "450 mL", "50 mL"],
      "answer": "250 mL",
      "explanation": "Solving: (x*30% + 350*10%) / (x + 350) = 20% => x = 250 mL."
    },
    // Question 16.4
    {
      "question": "In solution mixing, weighted averages help determine:",
      "options": [
        "Final concentrations",
        "Colors of liquids",
        "Lab room temperature",
        "Length of experiments",
        "Funny lab jokes"
      ],
      "answer": "Final concentrations",
      "explanation": "They calculate the combined concentration based on volumes and individual concentrations."
    },
    // Question 16.5
    {
      "question": "If Grace accidentally uses 350 mL of pure water instead of the 10% solution, what happens to the final concentration?",
      "options": [
        "It decreases significantly",
        "It increases",
        "It remains the same",
        "It becomes 100%",
        "It bubbles over"
      ],
      "answer": "It decreases significantly",
      "explanation": "Adding pure water dilutes the solution, lowering the concentration."
    }
  ]
},
// Stage 17
{
  "text": "Jackson is calculating the average weight of animals in a shelter. There are 5 dogs averaging 20 kg each and 15 cats averaging 5 kg each.",
  "questions": [
    // Question 17.1
    {
      "question": "What is the weighted average weight of the animals?",
      "options": ["8.75 kg", "10 kg", "12 kg", "15 kg", "50 kg"],
      "answer": "8.75 kg",
      "explanation": "Weighted average = (5*20 kg + 15*5 kg) / (5 + 15) = (100 + 75) / 20 = 8.75 kg."
    },
    // Question 17.2
    {
      "question": "Why is the average weight closer to the cats' average weight?",
      "options": [
        "Because there are more cats",
        "Because cats are fluffy",
        "Because 5 kg is lighter",
        "Because dogs are sleeping",
        "Because Jackson likes cats"
      ],
      "answer": "Because there are more cats",
      "explanation": "The higher number of cats lowers the overall average weight."
    },
    // Question 17.3
    {
      "question": "If 5 more dogs of 20 kg each are added, what is the new weighted average weight?",
      "options": ["12.5 kg", "10 kg", "15 kg", "11.25 kg", "20 kg"],
      "answer": "11.25 kg",
      "explanation": "New weighted average = (10*20 kg + 15*5 kg) / 25 = (200 + 75) / 25 = 11 kg."
    },
    // Question 17.4
    {
      "question": "Weighted averages in this context help to calculate:",
      "options": [
        "Overall average weight",
        "Animals' favorite food",
        "Shelter's location",
        "Number of visitors",
        "Weather forecasts"
      ],
      "answer": "Overall average weight",
      "explanation": "They determine the average weight considering the number of each animal."
    },
    // Question 17.5
    {
      "question": "If the shelter only had cats, what would the average weight be?",
      "options": ["5 kg", "8.75 kg", "20 kg", "10 kg", "Zero kg"],
      "answer": "5 kg",
      "explanation": "With only cats, the average weight equals the cats' average weight of 5 kg."
    }
  ]
},
// Stage 18
{
  "text": "Isabella is analyzing the average rating of her app. She has 200 ratings of 4 stars and 50 ratings of 2 stars.",
  "questions": [
    // Question 18.1
    {
      "question": "What is the weighted average rating of her app?",
      "options": ["3.6 stars", "3.8 stars", "4 stars", "3.4 stars", "5 stars"],
      "answer": "3.6 stars",
      "explanation": "Weighted average = (200*4 + 50*2) / (200 + 50) = (800 + 100) / 250 = 3.6 stars."
    },
    // Question 18.2
    {
      "question": "Why does the lower number of 2-star ratings significantly affect the average?",
      "options": [
        "Because low ratings have a big impact",
        "Because stars are shiny",
        "Because 2 is less than 4",
        "Because Isabella worries a lot",
        "Because apps are tricky"
      ],
      "answer": "Because low ratings have a big impact",
      "explanation": "Even a smaller number of low ratings can decrease the overall average."
    },
    // Question 18.3
    {
      "question": "How many additional 5-star ratings are needed to raise the average to 4 stars?",
      "options": ["150", "100", "200", "50", "500"],
      "answer": "150",
      "explanation": "Solving: (800 + 100 + x*5) / (250 + x) = 4 => x = 150."
    },
    // Question 18.4
    {
      "question": "Weighted averages in ratings help developers understand:",
      "options": [
        "Overall user satisfaction",
        "How to code",
        "App download speeds",
        "Weather patterns",
        "Best snack choices"
      ],
      "answer": "Overall user satisfaction",
      "explanation": "They reflect the general opinion of users based on ratings and their frequencies."
    },
    // Question 18.5
    {
      "question": "If all ratings were 4 stars, what would the average rating be?",
      "options": ["4 stars", "3.6 stars", "5 stars", "2 stars", "Zero stars"],
      "answer": "4 stars",
      "explanation": "With all ratings at 4 stars, the average would be exactly 4 stars."
    }
  ]
},
// Stage 19
{
  "text": "Lucas is combining two types of flour for baking. He uses 1 kg of Whole Wheat flour (protein content 12%) and 2 kg of All-Purpose flour (protein content 10%).",
  "questions": [
    // Question 19.1
    {
      "question": "What is the weighted average protein content of the flour mix?",
      "options": ["10.67%", "11%", "11.33%", "12%", "22%"],
      "answer": "10.67%",
      "explanation": "Weighted average = (1*12% + 2*10%) / 3 kg ≈ 10.67%."
    },
    // Question 19.2
    {
      "question": "Why is the protein content closer to 10% than 12%?",
      "options": [
        "Because more All-Purpose flour is used",
        "Because 10% is a nice number",
        "Because baking is fun",
        "Because Lucas prefers All-Purpose flour",
        "Because the oven is hot"
      ],
      "answer": "Because more All-Purpose flour is used",
      "explanation": "The greater quantity of All-Purpose flour lowers the overall protein content."
    },
    // Question 19.3
    {
      "question": "If Lucas wants a protein content of 11%, how much Whole Wheat flour should he use with 2 kg of All-Purpose flour?",
      "options": ["1.5 kg", "2 kg", "1 kg", "2.5 kg", "0.5 kg"],
      "answer": "1.5 kg",
      "explanation": "Solving: (x*12% + 2*10%) / (x + 2) = 11% => x = 1.5 kg."
    },
    // Question 19.4
    {
      "question": "Weighted averages in cooking help to:",
      "options": [
        "Achieve desired ingredient properties",
        "Decorate the kitchen",
        "Select music for baking",
        "Determine oven temperature",
        "Predict recipe popularity"
      ],
      "answer": "Achieve desired ingredient properties",
      "explanation": "They help combine ingredients to reach specific nutritional content."
    },
    // Question 19.5
    {
      "question": "If Lucas uses only Whole Wheat flour, what would the protein content be?",
      "options": ["12%", "10%", "11%", "22%", "0%"],
      "answer": "12%",
      "explanation": "Using only Whole Wheat flour results in a protein content of 12%."
    }
  ]
},
// Stage 20
{
  "text": "Amelia is calculating the average temperature over a day. The temperature was 15°C for 8 hours, 20°C for 10 hours, and 10°C for 6 hours.",
  "questions": [
    // Question 20.1
    {
      "question": "What is the weighted average temperature for the day?",
      "options": ["15.56°C", "16°C", "14°C", "15°C", "30°C"],
      "answer": "15.56°C",
      "explanation": "Weighted average = (8*15 + 10*20 + 6*10) / 24 ≈ 15.56°C."
    },
    // Question 20.2
    {
      "question": "Which temperature period has the greatest impact on the average?",
      "options": [
        "20°C, because it lasted the longest",
        "15°C, because it's in the middle",
        "10°C, because it's the lowest",
        "All periods equally",
        "The one when birds sing"
      ],
      "answer": "20°C, because it lasted the longest",
      "explanation": "The 20°C period lasted 10 hours, the longest duration."
    },
    // Question 20.3
    {
      "question": "If Amelia wants the average temperature to be 17°C, what should the temperature be during the 6-hour period?",
      "options": ["25°C", "30°C", "20°C", "22°C", "50°C"],
      "answer": "25°C",
      "explanation": "Solving: (8*15 + 10*20 + 6*x) / 24 = 17 => x = 25°C."
    },
    // Question 20.4
    {
      "question": "Weighted averages in temperature calculations help meteorologists to:",
      "options": [
        "Understand overall daily conditions",
        "Predict exact weather",
        "Control the weather",
        "Determine wind speed",
        "Find lost umbrellas"
      ],
      "answer": "Understand overall daily conditions",
      "explanation": "They provide an average that reflects the varying temperatures over time."
    },
    // Question 20.5
    {
      "question": "If the temperature was constant at 15°C all day, what would the average temperature be?",
      "options": ["15°C", "16°C", "17°C", "14°C", "0°C"],
      "answer": "15°C",
      "explanation": "A constant temperature results in the same average temperature."
    }
  ]
}


//-------------------------------------------------------------------------------------------------------------------							
				  ]
				}
        ];

		const stageCount = quizData[0].stages.length; // This is the correct way to get the number of stages


		const stateContents = {
			'Practice': `<div id="stage-number" class="stage-number">Stage 1 of ${stageCount}</div><div class="progress-bar-container"><div id="progress-bar" class="progress-bar"></div></div><div id="attempts">Attempts: 0</div><div id="quiz-content"></div><button class="center-button" onclick="checkStage()">Check Answers</button>`
			,'Subject Overview 🗝️': `<div class="subject-overview-content">     <h1>Introduction to Weighted Averages</h1>     <p>Weighted averages are a type of average where each value in a set is multiplied by a predetermined weight before the final calculation. This method gives different levels of importance to each value, making it a useful tool in various real-life scenarios such as calculating grades, financial assessments, and statistical analyses. In this guide, we'll explore what weighted averages are, how to calculate them, and provide examples suitable for 8th-grade students.</p>     <hr>     <h2>Table of Contents</h2>     <ol>         <li><a href="#what-are-weighted-averages">What Are Weighted Averages?</a></li>         <li><a href="#why-use-weighted-averages">Why Use Weighted Averages?</a></li>         <li><a href="#how-to-calculate-weighted-averages">How to Calculate Weighted Averages</a>             <ul>                 <li><a href="#step-by-step-calculation">Step-by-Step Calculation</a></li>                 <li><a href="#example-calculation">Example Calculation</a></li>             </ul>         </li>         <li><a href="#applications-of-weighted-averages">Applications of Weighted Averages</a></li>         <li><a href="#conclusion">Conclusion</a></li>     </ol>     <hr>     <h2 id="what-are-weighted-averages">What Are Weighted Averages?</h2>     <p>A weighted average takes into account the relative importance or frequency of each value in a data set. Unlike a simple average, where all values are treated equally, a weighted average assigns a weight to each value, reflecting its significance. This approach provides a more accurate representation when certain values carry more influence than others.</p>     <p>For example, when calculating a student's final grade, different assignments like homework, quizzes, and exams might have different weights.</p>     <hr>     <h2 id="why-use-weighted-averages">Why Use Weighted Averages?</h2>     <p>Weighted averages are used in situations where some values contribute more to the overall average than others. This method ensures that more important factors have a greater impact on the final result.</p>     <p>Common reasons to use weighted averages include:</p>     <ul>         <li>Assigning different importance to grades in different subjects.</li>         <li>Calculating average prices where quantities vary.</li>         <li>Determining overall performance metrics in sports or business.</li>     </ul>     <hr>     <h2 id="how-to-calculate-weighted-averages">How to Calculate Weighted Averages</h2>     <h3 id="step-by-step-calculation">Step-by-Step Calculation</h3>     <p>Calculating a weighted average involves the following steps:</p>     <ol>         <li><strong>Identify the values and their corresponding weights:</strong> Determine the data points you want to average and assign a weight to each based on its importance.</li>         <li><strong>Multiply each value by its weight:</strong> This gives you the weighted value for each data point.</li>         <li><strong>Sum all the weighted values:</strong> Add together all the results from the previous step.</li>         <li><strong>Sum all the weights:</strong> Add up all the weights you assigned.</li>         <li><strong>Divide the total weighted values by the total weights:</strong> This final division gives you the weighted average.</li>     </ol>     <h3 id="example-calculation">Example Calculation</h3>     <p>Let's calculate the weighted average of a student's grades in three subjects with different weightings.</p>     <ul>         <li><strong>Math:</strong> Grade = 85, Weight = 30%</li>         <li><strong>Science:</strong> Grade = 90, Weight = 40%</li>         <li><strong>English:</strong> Grade = 80, Weight = 30%</li>     </ul>     <p>Step 1: Multiply each grade by its weight:</p>     <ul>         <li>Math: 85 × 0.30 = 25.5</li>         <li>Science: 90 × 0.40 = 36</li>         <li>English: 80 × 0.30 = 24</li>     </ul>     <p>Step 2: Sum the weighted grades:</p>     <ul>         <li>25.5 + 36 + 24 = 85.5</li>     </ul>     <p>Step 3: Sum the weights:</p>     <ul>         <li>0.30 + 0.40 + 0.30 = 1.00</li>     </ul>     <p>Step 4: Divide the total weighted grades by the total weights:</p>     <ul>         <li>85.5 ÷ 1.00 = 85.5</li>     </ul>     <p>The weighted average grade is <strong>85.5</strong>.</p>     <hr>     <h2 id="applications-of-weighted-averages">Applications of Weighted Averages</h2>     <p>Weighted averages are widely used in various fields to provide more accurate and meaningful results. Here are some common applications:</p>     <ul>         <li><strong>Education:</strong> Calculating final grades by assigning different weights to assignments, tests, and participation.</li>         <li><strong>Finance:</strong> Determining the average cost of investments where different assets have varying amounts.</li>         <li><strong>Statistics:</strong> Computing averages in surveys where responses have different levels of significance.</li>         <li><strong>Sports:</strong> Ranking teams or players based on weighted performance metrics.</li>     </ul>     <hr>     <h2 id="conclusion">Conclusion</h2>     <p>Weighted averages provide a more nuanced and accurate way to calculate averages by considering the importance of each value in a data set. Understanding how to compute and apply weighted averages is essential for making informed decisions in academics, finance, and everyday life.</p>     <ul>         <li><strong>Key Points:</strong></li>         <li>Weighted averages assign different levels of importance to each value.</li>         <li>The calculation involves multiplying values by their weights, summing them, and dividing by the total weights.</li>         <li>They are useful in various real-life applications such as grading, finance, and statistics.</li>     </ul>     <p><strong>Remember:</strong> Always ensure that the weights accurately reflect the importance of each value to achieve a meaningful weighted average.</p>     <hr>     <p>By mastering weighted averages, you'll enhance your ability to analyze data more effectively and make better-informed decisions in multiple aspects of your life. Practice with different examples to become comfortable with this valuable mathematical tool!</p> </div>`		
			};


		function showExplanations() {
			// Hide the modal
			document.getElementById('quizModal').style.display = 'none';
			
			// Show all explanation panels
			document.querySelectorAll('.explanation-panel').forEach(exp => {
				exp.style.display = 'block';
			});
		}
		
        function setQuizExpansion(allow) {
            allowQuizExpansion = allow;
            adjustLayout();
        }

        function adjustLayout() {
            const wrapper = document.querySelector('.content-wrapper');
            const quizContainer = document.getElementById('quizContainer');
            const sidePanel1 = document.getElementById('sidePanel1');
            
            const isPanel1Visible = window.getComputedStyle(sidePanel1).display !== 'none';

            wrapper.style.justifyContent = 'space-between';

            if (isPanel1Visible) {
                sidePanel1.style.flex = '0 0 calc(20% - 0.5rem)';
                sidePanel1.style.maxWidth = 'calc(20% - 0.5rem)';
                quizContainer.style.flex = '1';
            } else {
                quizContainer.style.flex = '1';
                wrapper.style.justifyContent = 'center';
            }

            [sidePanel1, quizContainer].forEach(el => {
                el.style.display = 'block';
            });
        }

        function togglePanel(panelId) {
            const panel = document.getElementById(panelId);
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
            adjustLayout();
        }

        function updateSwitcherLayout() {
            const switchElement = document.getElementById('multiStateSwitch');
            const labels = switchElement.querySelectorAll('.switch-label');
            const handle = switchElement.querySelector('.switch-handle');

            labels.forEach(label => {
                label.style.flex = 'none';
                label.style.padding = '0 20px';
            });

            const activeLabel = switchElement.querySelector('.switch-label.active');
            if (activeLabel) {
                const switchRect = switchElement.getBoundingClientRect();
                const labelRect = activeLabel.getBoundingClientRect();

                handle.style.left = `${labelRect.left - switchRect.left}px`;
                handle.style.width = `${labelRect.width}px`;
            }

            switchElement.style.width = 'auto';
        }
        
        function switchTab(index) {
            const switchElement = document.getElementById('multiStateSwitch');
            const labels = switchElement.querySelectorAll('.switch-label');
            const activeStates = Array.from(labels).map(label => label.textContent);

            labels.forEach((label, i) => {
                label.classList.toggle('active', i === index);
            });

            updateSwitcherLayout();
            showContent(activeStates[index]);

            adjustLayout();
        }

        function showContent(state) {
            const tabContent = document.getElementById('tabContent');
            tabContent.innerHTML = stateContents[state] || '';

            if (state === 'Practice') {
                renderQuiz();
                updateProgressBar();
            }
        }

function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

function isTextEmpty(text) {
    return !text || text.trim() === "";
}

function renderQuiz() {
    const quizContainer = document.getElementById("quiz-content");
    quizContainer.innerHTML = '';

    // Only add stage text if it's not empty
    const stageText = quizData[0].stages[currentStage].text;
    if (!isTextEmpty(stageText)) {
        const stageTextElement = document.createElement("div");
        stageTextElement.className = "stage-text";
        stageTextElement.textContent = stageText;
        quizContainer.appendChild(stageTextElement);
    }

    // Render questions
    quizData[0].stages[currentStage].questions.forEach((questionData, index) => {
        // Create main question container
        const questionContainer = document.createElement("div");
        questionContainer.className = "question";
        questionContainer.style.padding = "0px"; 
		
        // Create question line
        const questionLine = document.createElement("div");
        questionLine.className = "question-one-line";

        const label = document.createElement("label");
        label.htmlFor = `q${index}`;
        label.textContent = `${index + 1}. ${questionData.question}`;

        const resultDiv = document.createElement("div");
        resultDiv.className = "result result-ltr";
        resultDiv.id = `result${index}`;

        const select = document.createElement("select");
        select.id = `q${index}`;
        select.name = `q${index}`;

        // Add default option
        const defaultOption = document.createElement("option");
        defaultOption.value = "";
        defaultOption.textContent = "Select";
		
        select.appendChild(defaultOption);

        // Add shuffled options
        const shuffledOptions = shuffleArray([...questionData.options]);
        shuffledOptions.forEach(option => {
            const optionElement = document.createElement("option");
            optionElement.value = option;
            optionElement.textContent = option;
            select.appendChild(optionElement);
        });

        // Assemble question line
        questionLine.appendChild(label);
        questionLine.appendChild(resultDiv);
        questionLine.appendChild(select);

        // Create explanation panel
        const explanationPanel = document.createElement("div");
        explanationPanel.className = "explanation-panel";
        explanationPanel.style.display = "none"; 

        const explanationText = document.createElement("div");
        explanationText.className = "explanation-panel-text";
        explanationText.textContent = questionData.explanation;

        explanationPanel.appendChild(explanationText);

        // Assemble full question container
        questionContainer.appendChild(questionLine);
        questionContainer.appendChild(explanationPanel);

        quizContainer.appendChild(questionContainer);
    });

    updateStageNumber();
}


function checkStage() {
    attempts++;
    document.getElementById("attempts").textContent = `Attempts: ${attempts}`;

    let correctCount = 0;
    const totalQuestions = quizData[0].stages[currentStage].questions.length;

    quizData[0].stages[currentStage].questions.forEach((questionData, index) => {
        const resultElement = document.getElementById(`result${index}`);
        const selectElement = document.getElementById(`q${index}`);
        const selectedAnswer = selectElement.value;

        // Check if the selected answer is correct or incorrect
        if (selectedAnswer === questionData.answer) {
            resultElement.textContent = "Correct!";
            resultElement.style.color = "green";
            correctCount++;
        } else {
            resultElement.textContent = "Incorrect.";
            resultElement.style.color = "red";
        }

        // Reveal explanations if the user reaches 10 attempts
        if (attempts >= 5) {
            // Reveal the explanation panel
            const explanationElement = selectElement.closest('.question').querySelector('.explanation-panel');
            explanationElement.style.display = "block"; // Make the explanation panel visible

            // Modify the explanation text to include the correct answer
            const explanationText = explanationElement.querySelector('.explanation-panel-text');
            explanationText.innerHTML = `The correct answer is: <strong>${questionData.answer}</strong>.<br>${questionData.explanation}`;
        }
    });

    if (correctCount === totalQuestions) {
        console.log(`Stage ${currentStage + 1}: ${correctCount} correct out of ${totalQuestions}`);
        addAnimalsToFarm(totalQuestions);

        if (currentStage < quizData[0].stages.length - 1) {
            singleStageConfetti();
            showEncouragingPopup(correctCount, totalQuestions, true);
            // Show both buttons in modal to allow moving to the next stage
            document.getElementById('modalNextButton').style.display = 'inline-block';
            document.getElementById('modalExplanationsButton').style.display = 'inline-block';
        } else {
            // Last stage completion
            currentStage++;
            updateProgressBar();
            allStagesConfetti();
            showModal("Congratulations! You've completed all stages!");
        }
    } else {
        // Show the encouraging popup if the stage is not complete
        showEncouragingPopup(correctCount, totalQuestions, false);

        if (attempts >= 5) {
            // If the user has reached 5 attempts, notify them about revealing the answers
            const modalMessage = document.getElementById('modalMessage');
            modalMessage.textContent = "You've reached the maximum number of attempts. The correct answers have been revealed.";
            showModal(modalMessage.textContent);
        }
    }

    scrollToTop();
}


	
		function showEncouragingPopup(correctCount, totalQuestions, isStageComplete) {
			const incorrectCount = totalQuestions - correctCount;
			let message = `You got ${correctCount} correct and ${incorrectCount} incorrect.`;
			
			// Add encouraging message based on performance
			if (correctCount === totalQuestions) {
				message += " Perfect score!";
			} else if (correctCount >= Math.ceil(totalQuestions * 0.7)) {
				message += " Great job! You're really getting the hang of this!";
			} else if (correctCount >= Math.ceil(totalQuestions * 0.5)) {
				message += " Good effort! Keep practicing and you'll improve in no time!";
			} else {
				message += " Don't give up! Every attempt helps you learn. Try again!";
			}

			// Add stage completion message if applicable
			if (isStageComplete) {
				message += "\n\n You've completed this stage. Moving to the next stage.";
			}

			showModal(message);
		}

		function initializeQuiz() {
			currentStage = 0;
			attempts = 0;
			updateProgressBar(); // This should now set the progress to 0%
			renderQuiz();
			document.getElementById("attempts").textContent = `Attempts: ${attempts}`;
			updateStageNumber();
		}

		function updateProgressBar() {
			const progressBar = document.getElementById("progress-bar");
			const completedStages = currentStage;
			const progress = (completedStages / stageCount) * 100;
			const roundedProgress = Math.min(100, Math.max(0, Math.round(progress)));
			progressBar.style.width = `${roundedProgress}%`;
			progressBar.textContent = roundedProgress > 0 ? `${roundedProgress}%` : '';
			console.log(`Progress updated: ${roundedProgress}% (Stage ${currentStage + 1} of ${stageCount})`);
		}

		function updateStageNumber() {
			const stageElement = document.getElementById("stage-number");
			stageElement.textContent = `Stage ${currentStage + 1} of ${stageCount}`;
		}

		function singleStageConfetti() {
			function randomInRange(min, max) {
				return Math.random() * (max - min) + min;
			}
			confetti({
				angle: randomInRange(55, 125),
				spread: randomInRange(50, 70),
				particleCount: randomInRange(50, 100),
				origin: { y: 0.6 },
			});
		}

		function allStagesConfetti() {
			const defaults = {
				spread: 360,
				ticks: 50,
				gravity: 0,
				decay: 0.94,
				startVelocity: 30,
				shapes: ["star"],
				colors: ["FFE400", "FFBD00", "E89400", "FFCA6C", "FDFFB8"],
			};
			function shoot() {
				confetti({
					...defaults,
					particleCount: 40,
					scalar: 1.2,
					shapes: ["star"],
				});
				confetti({
					...defaults,
					particleCount: 10,
					scalar: 0.75,
					shapes: ["circle"],
				});
			}
			setTimeout(shoot, 0);
			setTimeout(shoot, 100);
			setTimeout(shoot, 200);
		}

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
			    scrollToTopBtn.style.display = "none";
        }

        function initializeSwitch() {
            const switchElement = document.getElementById('multiStateSwitch');
            const labelsContainer = switchElement.querySelector('.switch-labels');
            const switchContainer = document.getElementById('switchContainer');
            
            const activeStates = Object.keys(stateContents).filter(state => stateContents[state].trim() !== '');
            
            if (activeStates.length <= 1) {
                switchContainer.style.display = 'none';
                if (activeStates.length === 1) {
                    showContent(activeStates[0]);
                }
                return;
            }
            
            switchContainer.style.display = 'flex';
            
            activeStates.forEach((state, index) => {
                const label = document.createElement('div');
                label.className = 'switch-label';
                label.textContent = state;
                label.addEventListener('click', () => switchTab(index));
                labelsContainer.appendChild(label);
            });
   
            const defaultTab = manuallySetDefaultTab !== null && manuallySetDefaultTab < activeStates.length
                ? manuallySetDefaultTab
                : 0;

            switchTab(defaultTab);
        }

		let farmAnimals = [];

		function addAnimalsToFarm(count) {
			const animalFarm = document.getElementById('animalFarm');
			let availableAnimals = animals.filter(animal => !farmAnimals.includes(animal));

			console.log(`Adding ${count} animals to the farm. Current farm size: ${farmAnimals.length}`);

			for (let i = 0; i < count; i++) {
				if (availableAnimals.length === 0) {
					console.log("No more unique animals available!");
					break;
				}

				const randomIndex = Math.floor(Math.random() * availableAnimals.length);
				const chosenAnimal = availableAnimals[randomIndex];

				const animalElement = document.createElement('li');
				animalElement.textContent = chosenAnimal;
				animalFarm.appendChild(animalElement);

				farmAnimals.push(chosenAnimal);
				availableAnimals.splice(randomIndex, 1);
				console.log(`Added animal: ${chosenAnimal}`);
			}

			console.log(`Farm size after addition: ${farmAnimals.length}`);
			logAnimalFarmState();
		}

		function logAnimalFarmState() {
			console.log(`Current animal farm state: ${farmAnimals.length} animals`);
			console.log(farmAnimals);
		}

		const animals = [
			"🐉", "🐻", "🦗", "🦁", "🐔", "🦂", "🐟", "🐣", "🐯", "🦡",
			"🐰", "🐍", "🦅", "🐈", "🦈", "🦜", "🦛", "🐀", "🐑",
			"🐮", "🦇", "🐇", "🦖", "🦀", "🦎", "🐃", "🐡", "🐤",
			"🐪", "🦥", "🐛", "🐅", "🐥", "🐱", "🐺", "🐕", "🦩", "🐊",
			"🐖", "🐢", "🕷", "🦕", "🦌", "🐁", "🦨", "🦘", "🐵",
			"🦑", "🐋", "🦓", "🦒", "🐲", "🦆", "🦉", "🐶", "🐄", "🦟",
			"🦃", "🦧", "🦏", "🐙", "🐿", "🦢", "🐜", "🐦", "🐞",
			"🦐", "🦔", "🐼", "🦄", "🦞", "🐫", "🐭", "🐆", "🦝",
			"🐠", "🦚", "🐴", "🐏", "🦮", "🐐", "🐹", "🐎", "🦋", "🐳",
			"🐨", "🐂", "🦍", "🦙", "🐬", "🦦", "🦊", "🐌", "🐓", "🐧",
			"🐷", "🐩", "🐘", "🐸", "🐝"
		];

		function showModal(message) {
			const modal = document.getElementById("quizModal");
			const modalMessage = document.getElementById("modalMessage");
			const modalClose = document.getElementsByClassName("modal-quiz-close")[0];
			const nextButton = document.getElementById("modalNextButton");
			const explanationsButton = document.getElementById("modalExplanationsButton");

			// Set message
			modalMessage.textContent = message;
			
			// Show modal
			modal.style.display = "block";

			// By default, hide both buttons
			nextButton.style.display = "none";
			explanationsButton.style.display = "none";

			// Close handlers
			modalClose.onclick = function() {
				modal.style.display = "none";
			}

			window.onclick = function(event) {
				if (event.target == modal) {
					modal.style.display = "none";
				}
			}
		}

		window.addEventListener('load', () => {
			initializeSwitch();
			initializeQuiz();
			adjustLayout();
			
			 document.getElementById('modalNextButton').addEventListener('click', () => {
				document.getElementById('quizModal').style.display = 'none';
				currentStage++;
				attempts = 0;
				renderQuiz();
				document.getElementById("attempts").textContent = `Attempts: ${attempts}`;
				updateProgressBar();
			});
			
			document.getElementById('modalExplanationsButton').addEventListener('click', showExplanations);
        });

        window.addEventListener('resize', adjustLayout);

        fetch('http://ez42.live/global/copyright.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('copyright-container').innerHTML = data;
            })
            .catch(error => console.error('Error loading copyright:', error));
			
		let scrollToTopBtn = document.getElementById("scrollToTopBtn");

			window.onscroll = function() {
				// Check if the scroll distance is more than twice the height of the screen
				if (document.body.scrollTop > window.innerHeight * 1.5 || 
					document.documentElement.scrollTop > window.innerHeight * 1.5) {
					scrollToTopBtn.style.display = "block";
				} else {
					scrollToTopBtn.style.display = "none";
				}
			};

		scrollToTopBtn.onclick = function() {
		  document.body.scrollTop = 0;
		  document.documentElement.scrollTop = 0;
		};	
    </script>
</body>
</html>