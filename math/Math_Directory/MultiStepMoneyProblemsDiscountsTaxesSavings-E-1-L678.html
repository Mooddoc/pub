<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ez42.live/global/analytics.js"></script>
    <script src="https://ez42.live/global/ads.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tsparticles/confetti@3.0.3/tsparticles.confetti.bundle.min.js"></script>
 	<link rel="stylesheet" href="http://www.ez42.live/global/styles/styles-eng.css"> <!-- Link to external CSS file -->
    <link rel="icon" type="image/svg+xml" href="http://www.ez42.live/global/styles/ez42-icon.svg">
    <title>✅ EZ42 LIVE - It's EZ</title>
	<style>
  
	</style>
</head>
<body>
    <div class="page-container">
        <div class="content-wrapper">
		
		<!--  Side Panel 1  -->
            <div id="sidePanel1" class="side-panel">
				<div class="logo-container">
					<a href="http://ez42.live" target="_blank" rel="noopener noreferrer">
						<img src="http://ez42.live/global/logo/logo.svg" alt="EZ42 Logo" class="logo-image">
					</a>
				</div>
			<h2>Instructions & Rules</h2>
			<ul>
																		<!--  PH1 - Instructions & Rules   -->	
                <li>Read the text and questions carefully.</li>
                <li>Select the best answer.</li>
                <li>Click "Check Answers" when you're ready to see how you did!</li>
                <li>You can check your answers multiple times to improve your score.</li>
                <li>Correct answers are revealed after 10 attempts.</li>
                <li>You must answer all questions correctly to proceed to the next stage.</li>
				<li>Have fun!</li>
			</ul>
            </div>
			
		<!--  Quiz Panel   -->
            <div id="quizContainer" class="quiz-container">
																			<!--  PH2 - Title  X  2 : A1 - 📗 Green, A2 - 📘 Blue, B1 - 📒 Yellow, 📙 Orange, 📔 Beige, 📓 Gray , 📕 Red-->	
                <h1>Multi-step money problems (discounts, taxes, or savings) 💸</h1>
                
                <div id="switchContainer" class="switch-container">
                    <div id="multiStateSwitch" class="switch">
                        <div class="switch-labels"></div>
                        <div class="switch-handle"></div>
                    </div>
                </div>
                <div id="tabContent"></div>
            </div>
			
		<!--  Side Panel 2  -->
			<div id="sidePanel2" class="side-panel">
				<h2>Animal Farm</h2>
				<p>Watch your farm grow as you progress! Each completed stage adds new animal friends to your collection.</p>
				<ul id="animalFarm" class="emoji-list">
				</ul>
			</div>
        </div>
    </div>
    <div id="copyright-container"></div>
 
    <!-- Modal -->
    <div id="quizModal" class="modal-quiz">
        <div class="modal-quiz-content">
            <span class="modal-quiz-close">&times;</span>
            <p id="modalMessage"></p>
            <button id="modalButton" class="modal-quiz-button">OK</button>
        </div>
    </div>
	<button id="scrollToTopBtn" title="Go to top">↑</button>
    <script>
        let isQuizExpanded = false;
        let allowQuizExpansion = true;

        let attempts = 0;
        let currentStage = 0;

        const manuallySetDefaultTab = 0;

																		//  PH3 - Quiz Data 
        const quizData = [ 												   	
				{
				  "stages": [

    // Stage 1 - Basic single discounts
    {
      "text": "Max wants to buy a new video game that costs $50. The store is having a 10% off sale.",
      "questions": [
        // Question 1.1
        {
          "question": "How much is the 10% discount?",
          "options": ["$5", "$10", "$15", "$4", "Video games should be free!"],
          "answer": "$5"
        },
        // Question 1.2
        {
          "question": "What is the final price of the game after the discount?",
          "options": ["$45", "$40", "$55", "$35", "Just play outside!"],
          "answer": "$45"
        },
        // Question 1.3
        {
          "question": "If Max has $60, how much money will he have left after buying the game?",
          "options": ["$15", "$10", "$20", "$25", "Keep all the money!"],
          "answer": "$15"
        },
        // Question 1.4
        {
          "question": "If Max buys two games at the same price, how much will he save in total?",
          "options": ["$10", "$5", "$15", "$20", "Math is no fun!"],
          "answer": "$10"
        },
        // Question 1.5
        {
          "question": "What percentage of Max's $60 would he spend on one game?",
          "options": ["75%", "65%", "85%", "70%", "Who needs percentages?"],
          "answer": "75%"
        }
      ]
    },
    // Stage 2 - Basic tax calculations
    {
      "text": "Emma is buying school supplies. She picks up a notebook for $5, pencils for $3, and an eraser for $2. The sales tax is 5%.",
      "questions": [
        // Question 2.1
        {
          "question": "What is the total cost before tax?",
          "options": ["$10", "$8", "$12", "$15", "School should be free!"],
          "answer": "$10"
        },
        // Question 2.2
        {
          "question": "How much is the 5% tax?",
          "options": ["$0.50", "$1.00", "$0.75", "$0.25", "Skip the tax!"],
          "answer": "$0.50"
        },
        // Question 2.3
        {
          "question": "What is the final cost including tax?",
          "options": ["$10.50", "$11.00", "$9.50", "$12.00", "Use old supplies!"],
          "answer": "$10.50"
        },
        // Question 2.4
        {
          "question": "If Emma pays with a $20 bill, how much change should she get?",
          "options": ["$9.50", "$10.00", "$8.50", "$11.00", "Keep the change!"],
          "answer": "$9.50"
        },
        // Question 2.5
        {
          "question": "What item makes up the largest percentage of her purchase?",
          "options": ["Notebook", "Pencils", "Eraser", "They're equal", "Who needs math?"],
          "answer": "Notebook"
        }
      ]
    },
    // Stage 3 - Simple combination of discount and tax
    {
      "text": "Sarah finds a t-shirt for $20. The store is offering a 20% discount, and then charges 5% sales tax on the discounted price.",
      "questions": [
        // Question 3.1
        {
          "question": "How much is the 20% discount?",
          "options": ["$4", "$5", "$3", "$6", "Take it for free!"],
          "answer": "$4"
        },
        // Question 3.2
        {
          "question": "What is the price after the discount?",
          "options": ["$16", "$15", "$17", "$14", "Just wear old clothes!"],
          "answer": "$16"
        },
        // Question 3.3
        {
          "question": "How much is the 5% tax on the discounted price?",
          "options": ["$0.80", "$1.00", "$0.75", "$0.90", "Taxes are boring!"],
          "answer": "$0.80"
        },
        // Question 3.4
        {
          "question": "What is the final price including both discount and tax?",
          "options": ["$16.80", "$17.00", "$16.50", "$17.50", "Math makes me dizzy!"],
          "answer": "$16.80"
        },
        // Question 3.5
        {
          "question": "How much did Sarah save overall compared to the original price with tax?",
          "options": ["$4.20", "$4.00", "$3.80", "$4.50", "Savings are hard!"],
          "answer": "$4.20"
        }
      ]
    },
    // Stage 4
    {
      "text": "Joey is buying snacks for a class party. Chips are $3 per bag, and he needs 8 bags. The store has a 'buy 3 get 1 free' offer.",
      "questions": [
        // Question 4.1
        {
          "question": "How many free bags will Joey get?",
          "options": ["2", "1", "3", "4", "All snacks should be free!"],
          "answer": "2"
        },
        // Question 4.2
        {
          "question": "How many bags will Joey actually pay for?",
          "options": ["6", "5", "7", "8", "Just bring carrots!"],
          "answer": "6"
        },
        // Question 4.3
        {
          "question": "What is the total cost for all the chips?",
          "options": ["$18", "$24", "$15", "$21", "Too much math!"],
          "answer": "$18"
        },
        // Question 4.4
        {
          "question": "How much money did Joey save with the offer?",
          "options": ["$6", "$3", "$9", "$12", "Savings are confusing!"],
          "answer": "$6"
        },
        // Question 4.5
        {
          "question": "What is the actual price per bag after the discount?",
          "options": ["$2.25", "$2.50", "$2.00", "$3.00", "Who's counting?"],
          "answer": "$2.25"
        }
      ]
    },
    // Stage 5
    {
      "text": "Lily has saved $40 from her allowance. She wants to buy a board game that costs $35. The store is having a 15% off sale, and there's a 6% sales tax.",
      "questions": [
        // Question 5.1
        {
          "question": "How much is the 15% discount?",
          "options": ["$5.25", "$4.75", "$5.50", "$6.00", "Math is tricky!"],
          "answer": "$5.25"
        },
        // Question 5.2
        {
          "question": "What's the price after the discount?",
          "options": ["$29.75", "$30.25", "$28.50", "$31.00", "Too many numbers!"],
          "answer": "$29.75"
        },
        // Question 5.3
        {
          "question": "How much is the 6% tax on the discounted price?",
          "options": ["$1.79", "$1.50", "$2.00", "$1.25", "Skip the tax!"],
          "answer": "$1.79"
        },
        // Question 5.4
        {
          "question": "What's the final price including tax?",
          "options": ["$31.54", "$30.54", "$32.54", "$29.54", "My brain hurts!"],
          "answer": "$31.54"
        },
        // Question 5.5
        {
          "question": "How much money will Lily have left from her $40?",
          "options": ["$8.46", "$7.46", "$9.46", "$6.46", "Keep all the money!"],
          "answer": "$8.46"
        }
      ]
    },
	// Stage 6 - The School Bookstore Scenario
	{
	  "text": "The school bookstore is selling notebooks at $4 each or 3 for $10. Alex needs 5 notebooks and has a 10% student discount card.",
	  "questions": [
		// Question 6.1
		{
		  "question": "Which is cheaper for 3 notebooks: buying them individually or buying the bundle?",
		  "options": ["Buying individually", "Buying the bundle", "Same price", "Need a calculator!", "Who needs notebooks?"],
		  "answer": "Buying the bundle"
		},
		// Question 6.2
		{
		  "question": "How much would 5 notebooks cost before applying the student discount?",
		  "options": ["$18", "$16", "$20", "$14", "Too complicated!"],
		  "answer": "$18"
		},
		// Question 6.3
		{
		  "question": "How much will Alex save using the bundle compared to buying all notebooks individually?",
		  "options": ["$2", "$4", "$6", "$5", "Math overload!"],
		  "answer": "$2"
		},
		// Question 6.4
		{
		  "question": "What's the final price after applying the 10% student discount?",
		  "options": ["$16.20", "$15.00", "$14.40", "$17.80", "Skip school!"],
		  "answer": "$16.20"
		},
		// Question 6.5
		{
		  "question": "What's the final price per notebook after all discounts?",
		  "options": ["$3.24", "$3.00", "$3.50", "$2.90", "Just use paper!"],
		  "answer": "$3.24"
		}
	  ]
	},
    // Stage 7
    {
      "text": "Mike is saving for a new bike that costs $200. He saves $15 per week from his allowance. The bike shop announces a 20% off sale that will last for 4 weeks.",
      "questions": [
        // Question 7.1
        {
          "question": "How much will the bike cost during the sale?",
          "options": ["$160", "$150", "$170", "$180", "Just walk!"],
          "answer": "$160"
        },
        // Question 7.2
        {
          "question": "How many weeks would it take to save for the sale price?",
          "options": ["11 weeks", "10 weeks", "12 weeks", "13 weeks", "Too long to wait!"],
          "answer": "11 weeks"
        },
        // Question 7.3
        {
          "question": "How much will Mike save if he buys during the sale?",
          "options": ["$40", "$35", "$45", "$50", "Savings are boring!"],
          "answer": "$40"
        },
        // Question 7.4
        {
          "question": "If Mike has already saved for 8 weeks, how much more does he need?",
          "options": ["$40", "$45", "$35", "$50", "Keep saving forever!"],
          "answer": "$40"
        },
        // Question 7.5
        {
          "question": "How many more weeks of saving does he need?",
          "options": ["3", "2", "4", "5", "Buy a scooter instead!"],
          "answer": "3"
        }
      ]
    },
    // Stage 8
    {
      "text": "A candy store offers a mix-and-match deal: any 5 candies for $2. Each candy normally costs 50 cents. Lucy wants to buy candies for her 15 classmates plus her teacher.",
      "questions": [
        // Question 8.1
        {
          "question": "How many total candies does Lucy need?",
          "options": ["16", "15", "17", "14", "Skip the candy!"],
          "answer": "16"
        },
        // Question 8.2
        {
          "question": "How many complete sets of 5 can Lucy make?",
          "options": ["3", "2", "4", "5", "Too much counting!"],
          "answer": "3"
        },
        // Question 8.3
        {
          "question": "How many extra candies will she need to buy individually?",
          "options": ["1", "2", "3", "0", "Math makes me hungry!"],
          "answer": "1"
        },
        // Question 8.4
        {
          "question": "What's the total cost using the best combination of deals?",
          "options": ["$6.50", "$7.00", "$6.00", "$7.50", "Give up counting!"],
          "answer": "$6.50"
        },
        // Question 8.5
        {
          "question": "How much does Lucy save compared to buying all candies separately?",
          "options": ["$1.50", "$1.00", "$2.00", "$2.50", "Savings are hard!"],
          "answer": "$1.50"
        }
      ]
    },
    // Stage 9
    {
      "text": "The school's art club is selling handmade bracelets for $5 each to raise money. They offer a 'buy 4 get 1 free' deal. Sofia has $30 to spend and wants to buy bracelets for her friends.",
      "questions": [
        // Question 9.1
        {
          "question": "How many bracelets can Sofia get if she uses the deal?",
          "options": ["7", "6", "5", "8", "Make your own!"],
          "answer": "7"
        },
        // Question 9.2
        {
          "question": "How much will Sofia actually pay for the bracelets?",
          "options": ["$25", "$30", "$20", "$35", "Too expensive!"],
          "answer": "$25"
        },
        // Question 9.3
        {
          "question": "What is the actual cost per bracelet after the deal?",
          "options": ["$3.57", "$4.00", "$3.75", "$3.25", "Math overload!"],
          "answer": "$3.57"
        },
        // Question 9.4
        {
          "question": "How much money will Sofia have left?",
          "options": ["$5", "$3", "$7", "$4", "Keep the change!"],
          "answer": "$5"
        },
        // Question 9.5
        {
          "question": "How much did Sofia save with the deal?",
          "options": ["$5", "$4", "$6", "$3", "Who's counting?"],
          "answer": "$5"
        }
      ]
    },
    // Stage 10
    {
      "text": "Sam's baseball team is ordering pizza for their end-of-season party. Each pizza costs $12 and feeds 3 people. There are 15 people total, and they want everyone to have at least 2 slices. The pizza place offers 10% off orders over $50.",
      "questions": [
        // Question 10.1
        {
          "question": "How many pizzas do they need to order?",
          "options": ["5", "4", "6", "3", "Bring sandwiches!"],
          "answer": "5"
        },
        // Question 10.2
        {
          "question": "What's the total cost before any discount?",
          "options": ["$60", "$48", "$72", "$36", "Too many numbers!"],
          "answer": "$60"
        },
        // Question 10.3
        {
          "question": "How much is the 10% discount?",
          "options": ["$6", "$5", "$7", "$4", "Skip the math!"],
          "answer": "$6"
        },
        // Question 10.4
        {
          "question": "What's the final cost after the discount?",
          "options": ["$54", "$56", "$52", "$58", "Order less!"],
          "answer": "$54"
        },
        // Question 10.5
        {
          "question": "If they split the cost equally, how much should each person pay?",
          "options": ["$3.60", "$4.00", "$3.20", "$3.80", "Too complicated!"],
          "answer": "$3.60"
        }
      ]
    },
    // Stage 11
    {
      "text": "The school book fair offers a 'Reading Bundle': any 3 books for $25. Individual books cost $10 each. They also have bookmarks for $2 each or 3 for $5. Maria has $40 to spend.",
      "questions": [
        // Question 11.1
        {
          "question": "How much would Maria save buying 3 books in the bundle versus individually?",
          "options": ["$5", "$3", "$7", "$4", "Reading is priceless!"],
          "answer": "$5"
        },
        // Question 11.2
        {
          "question": "If Maria buys the book bundle, how much money will she have left for bookmarks?",
          "options": ["$15", "$10", "$20", "$12", "Keep all the money!"],
          "answer": "$15"
        },
        // Question 11.3
        {
          "question": "How many bookmarks can she buy with the remaining money using the best deal?",
          "options": ["9", "7", "8", "6", "Just use paper!"],
          "answer": "9"
        },
        // Question 11.4
        {
          "question": "What's the total amount Maria will save using both bundle deals?",
          "options": ["$7", "$5", "$8", "$6", "Math is exhausting!"],
          "answer": "$7"
        },
        // Question 11.5
        {
          "question": "What's the average cost per item (books and bookmarks) with all deals?",
          "options": ["$3.33", "$4.00", "$3.50", "$3.75", "Too much division!"],
          "answer": "$3.33"
        }
      ]
    },
    // Stage 12
    {
      "text": "David's class is planning a field trip. The museum entry is $8 per student, and lunch is $7 per student. For groups of 20 or more, the museum offers a 25% discount. There are 24 students going.",
      "questions": [
        // Question 12.1
        {
          "question": "What would be the total museum cost without the discount?",
          "options": ["$192", "$180", "$200", "$185", "Stay at school!"],
          "answer": "$192"
        },
        // Question 12.2
        {
          "question": "How much is the 25% museum discount for the whole group?",
          "options": ["$48", "$45", "$50", "$52", "Math is hard!"],
          "answer": "$48"
        },
        // Question 12.3
        {
          "question": "What's the total museum cost after the group discount?",
          "options": ["$144", "$150", "$140", "$148", "Too many numbers!"],
          "answer": "$144"
        },
        // Question 12.4
        {
          "question": "What's the total cost for lunch for all students?",
          "options": ["$168", "$160", "$175", "$170", "Pack lunch instead!"],
          "answer": "$168"
        },
        // Question 12.5
        {
          "question": "What's the total cost per student for the whole trip?",
          "options": ["$13", "$15", "$12", "$14", "Skip the trip!"],
          "answer": "$13"
        }
      ]
    },
    // Stage 13
    {
      "text": "The school store is having a 'Back to School' sale. Notebooks are $3 each (normally $4), folders are $2 each (normally $3), and pencil packs are $4 each (normally $5). Students get an extra 10% off their total purchase.",
      "questions": [
        // Question 13.1
        {
          "question": "If you buy 2 of each item, how much would it cost before the student discount?",
          "options": ["$18", "$20", "$16", "$22", "Use old supplies!"],
          "answer": "$18"
        },
        // Question 13.2
        {
          "question": "How much money do you save from the regular prices on 2 of each item?",
          "options": ["$6", "$4", "$8", "$5", "Savings are confusing!"],
          "answer": "$6"
        },
        // Question 13.3
        {
          "question": "What's the 10% student discount on the sale price of 2 of each item?",
          "options": ["$1.80", "$2.00", "$1.60", "$2.20", "Skip the discount!"],
          "answer": "$1.80"
        },
        // Question 13.4
        {
          "question": "What's the final cost after all discounts?",
          "options": ["$16.20", "$17.00", "$15.80", "$16.50", "Too much math!"],
          "answer": "$16.20"
        },
        // Question 13.5
        {
          "question": "What's the total percentage saved from original prices?",
          "options": ["32.5%", "30%", "35%", "28%", "Percentages hurt!"],
          "answer": "32.5%"
        }
      ]
    },
    // Stage 14
    {
      "text": "A movie ticket costs $12 for students. The theater has a special Thursday deal where tickets are 30% off. Popcorn is $6 and sodas are $4, or you can get both as a combo for $8.",
      "questions": [
        // Question 14.1
        {
          "question": "How much is a student ticket on Thursday?",
          "options": ["$8.40", "$9.00", "$7.80", "$8.80", "Watch at home!"],
          "answer": "$8.40"
        },
        // Question 14.2
        {
          "question": "How much do you save by getting the popcorn-soda combo?",
          "options": ["$2", "$1", "$3", "$4", "Skip the snacks!"],
          "answer": "$2"
        },
        // Question 14.3
        {
          "question": "What's the total cost for a Thursday movie with the combo?",
          "options": ["$16.40", "$15.40", "$17.40", "$18.40", "Too expensive!"],
          "answer": "$16.40"
        },
        // Question 14.4
        {
          "question": "If three friends go together on Thursday, how much do they save on tickets?",
          "options": ["$10.80", "$9.60", "$12.00", "$11.40", "Math overload!"],
          "answer": "$10.80"
        },
        // Question 14.5
        {
          "question": "If each friend gets a combo, what's the total group savings?",
          "options": ["$16.80", "$15.60", "$18.00", "$17.40", "Stay home!"],
          "answer": "$16.80"
        }
      ]
    },
    // Stage 15
    {
      "text": "Jake is selling chocolate bars for his soccer team fundraiser. Each bar costs $4. If someone buys 5 bars, they get one free. His goal is to raise $200.",
      "questions": [
        // Question 15.1
        {
          "question": "How much do 5 chocolate bars cost with the free one included?",
          "options": ["$20", "$24", "$16", "$22", "Too much chocolate!"],
          "answer": "$20"
        },
        // Question 15.2
        {
          "question": "What's the actual price per bar when buying 6 (with one free)?",
          "options": ["$3.33", "$3.50", "$3.25", "$3.75", "Math makes me hungry!"],
          "answer": "$3.33"
        },
        // Question 15.3
        {
          "question": "How many bars does Jake need to sell to reach $200?",
          "options": ["50", "45", "55", "40", "That's a lot!"],
          "answer": "50"
        },
        // Question 15.4
        {
          "question": "If all sales use the 'buy 5 get 1 free' deal, how many bars will Jake actually give out?",
          "options": ["60", "50", "55", "45", "Too much counting!"],
          "answer": "60"
        },
        // Question 15.5
        {
          "question": "If Jake sells to 10 customers who each use the deal, how much money will he raise?",
          "options": ["$200", "$180", "$220", "$240", "Need a calculator!"],
          "answer": "$200"
        }
      ]
    },
    // Stage 16
    {
      "text": "The school cafeteria offers a lunch meal deal: main dish ($5), side ($3), and drink ($2). Buying the complete meal saves 15%. Students can also use their reward card for an extra 5% off.",
      "questions": [
        // Question 16.1
        {
          "question": "What's the regular total price without any deals?",
          "options": ["$10", "$9", "$11", "$8", "Bring lunch from home!"],
          "answer": "$10"
        },
        // Question 16.2
        {
          "question": "How much does the 15% meal deal save?",
          "options": ["$1.50", "$1.00", "$2.00", "$1.25", "Math makes me hungry!"],
          "answer": "$1.50"
        },
        // Question 16.3
        {
          "question": "What's the price after the meal deal discount?",
          "options": ["$8.50", "$9.00", "$8.00", "$9.50", "Too many numbers!"],
          "answer": "$8.50"
        },
        // Question 16.4
        {
          "question": "How much extra is saved with the 5% reward card?",
          "options": ["$0.43", "$0.50", "$0.40", "$0.45", "Skip the math!"],
          "answer": "$0.43"
        },
        // Question 16.5
        {
          "question": "What's the final price using both discounts?",
          "options": ["$8.07", "$8.25", "$7.95", "$8.15", "Just eat snacks!"],
          "answer": "$8.07"
        }
      ]
    },
    // Stage 17
    {
      "text": "Jenny is buying supplies for her art club. Colored markers are $8 per pack with a 'buy 2 get 1 half price' deal. She needs 7 packs and has a 10% club discount card.",
      "questions": [
        // Question 17.1
        {
          "question": "How many packs will get the half-price discount?",
          "options": ["2", "3", "1", "4", "Use crayons instead!"],
          "answer": "2"
        },
        // Question 17.2
        {
          "question": "How much do the full-price packs cost?",
          "options": ["$40", "$32", "$48", "$36", "Too expensive!"],
          "answer": "$40"
        },
        // Question 17.3
        {
          "question": "How much do the half-price packs cost?",
          "options": ["$8", "$12", "$4", "$16", "Just draw in pencil!"],
          "answer": "$8"
        },
        // Question 17.4
        {
          "question": "What's the total before the club discount?",
          "options": ["$48", "$52", "$44", "$56", "Need a calculator!"],
          "answer": "$48"
        },
        // Question 17.5
        {
          "question": "What's the final cost after the 10% club discount?",
          "options": ["$43.20", "$45.60", "$41.80", "$44.40", "Math overload!"],
          "answer": "$43.20"
        }
      ]
    },
    // Stage 18
    {
      "text": "The bowling alley has a weekend special: $4 per game (usually $6) or $15 for unlimited games. Shoe rental is $3. Peter and his two friends want to go bowling.",
      "questions": [
        // Question 18.1
        {
          "question": "How much would 3 games each cost the group at the regular price?",
          "options": ["$54", "$48", "$60", "$52", "Stay home instead!"],
          "answer": "$54"
        },
        // Question 18.2
        {
          "question": "How much would 3 games each cost with the weekend special?",
          "options": ["$36", "$30", "$42", "$38", "Too much counting!"],
          "answer": "$36"
        },
        // Question 18.3
        {
          "question": "What's the total cost of shoe rental for the group?",
          "options": ["$9", "$6", "$12", "$15", "Bowl in socks!"],
          "answer": "$9"
        },
        // Question 18.4
        {
          "question": "If they plan to play 4 games each, which is cheaper: per game or unlimited?",
          "options": ["Unlimited", "Per game", "Same price", "Need more info", "Math is hard!"],
          "answer": "Unlimited"
        },
        // Question 18.5
        {
          "question": "What's the best total price for the group to play 4 games each including shoes?",
          "options": ["$54", "$60", "$48", "$58", "Too expensive!"],
          "answer": "$54"
        }
      ]
    },
    // Stage 19
    {
      "text": "A comic book store is having a sale: All comics are $3 each (usually $4), or buy 5 get 2 free. They also have a stamp card where every $20 spent earns a $5 discount on the next purchase.",
      "questions": [
        // Question 19.1
        {
          "question": "How much money is saved when buying 7 comics using the 'buy 5 get 2 free' deal?",
          "options": ["$6", "$8", "$4", "$10", "Read online!"],
          "answer": "$6"
        },
        // Question 19.2
        {
          "question": "If someone buys 7 comics with the deal, how many stamp cards will they fill?",
          "options": ["0", "1", "2", "3", "Skip the stamps!"],
          "answer": "0"
        },
        // Question 19.3
        {
          "question": "How many comics would you need to buy to fill one stamp card?",
          "options": ["7", "6", "8", "5", "Too much math!"],
          "answer": "7"
        },
        // Question 19.4
        {
          "question": "What's the best deal when buying 10 comics?",
          "options": ["Buy 5 get 2 free twice", "Buy each for $3", "Mix the deals", "No difference", "Who reads comics?"],
          "answer": "Buy 5 get 2 free twice"
        },
        // Question 19.5
        {
          "question": "How much would 10 comics cost using the best deal?",
          "options": ["$18", "$20", "$24", "$22", "Save your money!"],
          "answer": "$18"
        }
      ]
    },
    // Stage 20
    {
      "text": "The mini-golf course charges $8 per person. Groups of 4 or more get 20% off. On Tuesdays, everyone gets an additional $2 off after all other discounts. A family of 5 goes on Tuesday.",
      "questions": [
        // Question 20.1
        {
          "question": "What's the regular cost for 5 people without any discounts?",
          "options": ["$40", "$35", "$45", "$50", "Play at home!"],
          "answer": "$40"
        },
        // Question 20.2
        {
          "question": "How much is the 20% group discount?",
          "options": ["$8", "$10", "$6", "$12", "Math is tough!"],
          "answer": "$8"
        },
        // Question 20.3
        {
          "question": "What's the cost after the group discount?",
          "options": ["$32", "$30", "$34", "$36", "Too expensive!"],
          "answer": "$32"
        },
        // Question 20.4
        {
          "question": "How much is the total Tuesday discount for the family?",
          "options": ["$10", "$8", "$12", "$6", "Skip Tuesday!"],
          "answer": "$10"
        },
        // Question 20.5
        {
          "question": "What's the final cost for the family?",
          "options": ["$22", "$24", "$20", "$26", "Stay home instead!"],
          "answer": "$22"
        }
      ]
    },
    // Stage 21
    {
      "text": "A new game costs $50. The store offers a trade-in deal where you get 40% of your old game's value towards the new game. You have two old games worth $30 and $20.",
      "questions": [
        // Question 21.1
        {
          "question": "How much trade-in credit do you get for the $30 game?",
          "options": ["$12", "$15", "$10", "$18", "Keep old games!"],
          "answer": "$12"
        },
        // Question 21.2
        {
          "question": "How much trade-in credit do you get for the $20 game?",
          "options": ["$8", "$10", "$6", "$12", "Math hurts!"],
          "answer": "$8"
        },
        // Question 21.3
        {
          "question": "What's the total trade-in credit?",
          "options": ["$20", "$18", "$22", "$16", "Too complicated!"],
          "answer": "$20"
        },
        // Question 21.4
        {
          "question": "How much will you need to pay after using both trade-ins?",
          "options": ["$30", "$35", "$25", "$40", "Save your money!"],
          "answer": "$30"
        },
        // Question 21.5
        {
          "question": "What percentage of the new game's price did you save?",
          "options": ["40%", "35%", "45%", "30%", "Percentages again!"],
          "answer": "40%"
        }
      ]
    },
    // Stage 22
    {
      "text": "The school yearbook costs $25. If you order before October, you get 20% off. You can also get $5 off by helping sell advertisements. The photography club members get an additional 10% off after other discounts.",
      "questions": [
        // Question 22.1
        {
          "question": "How much would you save with the early order discount?",
          "options": ["$5", "$4", "$6", "$3", "Skip the yearbook!"],
          "answer": "$5"
        },
        // Question 22.2
        {
          "question": "What's the price after both early order and advertisement discounts?",
          "options": ["$15", "$18", "$12", "$20", "Too many numbers!"],
          "answer": "$15"
        },
        // Question 22.3
        {
          "question": "How much extra would a photography club member save?",
          "options": ["$1.50", "$2.00", "$1.00", "$2.50", "Math overload!"],
          "answer": "$1.50"
        },
        // Question 22.4
        {
          "question": "What's the final price for a photography club member using all discounts?",
          "options": ["$13.50", "$14.00", "$13.00", "$15.00", "Just take selfies!"],
          "answer": "$13.50"
        },
        // Question 22.5
        {
          "question": "What's the total percentage saved using all discounts?",
          "options": ["46%", "40%", "50%", "44%", "Percentages hurt!"],
          "answer": "46%"
        }
      ]
    },
    // Stage 23
    {
      "text": "The ice cream shop has a build-your-own sundae deal. Base price is $4, each topping is 50¢, and whipped cream is 75¢. Buy 3 sundaes, get free whipped cream on all. Emma and her three friends want sundaes.",
      "questions": [
        // Question 23.1
        {
          "question": "How much would one sundae cost with 3 toppings and whipped cream?",
          "options": ["$6.25", "$6.00", "$6.50", "$5.75", "Just get vanilla!"],
          "answer": "$6.25"
        },
        // Question 23.2
        {
          "question": "How much would 4 identical sundaes cost without any deals?",
          "options": ["$25", "$24", "$26", "$23", "Share one sundae!"],
          "answer": "$25"
        },
        // Question 23.3
        {
          "question": "How much do they save on whipped cream with the deal?",
          "options": ["$3", "$2", "$4", "$2.50", "Skip the cream!"],
          "answer": "$3"
        },
        // Question 23.4
        {
          "question": "What's the total cost for 4 sundaes with the deal?",
          "options": ["$22", "$24", "$20", "$26", "Too expensive!"],
          "answer": "$22"
        },
        // Question 23.5
        {
          "question": "If they split the bill equally, how much does each friend pay?",
          "options": ["$5.50", "$6.00", "$5.00", "$5.75", "Math brain freeze!"],
          "answer": "$5.50"
        }
      ]
    },
    // Stage 24
    {
      "text": "The swimming pool offers different pass options: $8 for one day, $20 for a 3-day pass, or $35 for a weekly pass. During summer break, Lisa wants to go swimming for 9 days.",
      "questions": [
        // Question 24.1
        {
          "question": "How much would 9 individual day passes cost?",
          "options": ["$72", "$70", "$75", "$68", "Stay home!"],
          "answer": "$72"
        },
        // Question 24.2
        {
          "question": "How much would it cost using three 3-day passes?",
          "options": ["$60", "$55", "$65", "$58", "Too much math!"],
          "answer": "$60"
        },
        // Question 24.3
        {
          "question": "What's the cost using one weekly pass plus two day passes?",
          "options": ["$51", "$48", "$54", "$45", "Need a calculator!"],
          "answer": "$51"
        },
        // Question 24.4
        {
          "question": "Which combination of passes is cheapest?",
          "options": ["Weekly + 2 days", "Three 3-day passes", "Individual days", "Two 3-day + 3 days", "Skip swimming!"],
          "answer": "Weekly + 2 days"
        },
        // Question 24.5
        {
          "question": "How much money does Lisa save using the best combination?",
          "options": ["$21", "$18", "$24", "$15", "Savings are hard!"],
          "answer": "$21"
        }
      ]
    },
    // Stage 25
    {
      "text": "A bike rental shop charges $10 per hour or $40 for a full day (8 hours). Helmets are required and cost $5 each. On weekdays before noon, there's a 25% discount on everything.",
      "questions": [
        // Question 25.1
        {
          "question": "For a 6-hour rental, which is cheaper: hourly or full day rate?",
          "options": ["Hourly", "Full day", "Same price", "Need more info", "Walk instead!"],
          "answer": "Hourly"
        },
        // Question 25.2
        {
          "question": "How much would a 6-hour rental plus helmet cost on a weekend?",
          "options": ["$65", "$60", "$70", "$55", "Too expensive!"],
          "answer": "$65"
        },
        // Question 25.3
        {
          "question": "How much would the same rental cost on a weekday morning?",
          "options": ["$48.75", "$50.00", "$45.50", "$52.25", "Stay home!"],
          "answer": "$48.75"
        },
        // Question 25.4
        {
          "question": "How much is saved using the weekday morning discount?",
          "options": ["$16.25", "$15.00", "$17.50", "$14.75", "Math hurts!"],
          "answer": "$16.25"
        },
        // Question 25.5
        {
          "question": "For a 3-hour weekday morning rental with helmet, what's the total cost?",
          "options": ["$26.25", "$28.50", "$24.00", "$30.00", "Just walk!"],
          "answer": "$26.25"
        }
      ]
    },
    // Stage 26
    {
      "text": "The arcade has special token deals: 20 tokens for $5, 50 tokens for $10, or 125 tokens for $20. Most games cost 4 tokens, but some special games cost 6 tokens.",
      "questions": [
        // Question 26.1
        {
          "question": "How much does each token cost in the best deal?",
          "options": ["16¢", "20¢", "18¢", "15¢", "Play outside!"],
          "answer": "16¢"
        },
        // Question 26.2
        {
          "question": "How many regular (4-token) games can you play with 50 tokens?",
          "options": ["12", "10", "14", "8", "Too much counting!"],
          "answer": "12"
        },
        // Question 26.3
        {
          "question": "If you want to play 8 regular games and 4 special games, how many tokens do you need?",
          "options": ["56", "50", "60", "54", "Math overload!"],
          "answer": "56"
        },
        // Question 26.4
        {
          "question": "What's the cheapest way to buy exactly 56 tokens?",
          "options": ["50 + 6 tokens", "20 + 20 + 20", "All individual", "Buy 125", "Skip arcade!"],
          "answer": "50 + 6 tokens"
        },
        // Question 26.5
        {
          "question": "How much would this cost in total?",
          "options": ["$11.50", "$12.00", "$11.00", "$13.00", "Save your money!"],
          "answer": "$11.50"
        }
      ]
    },
    // Stage 27
    {
      "text": "The school store's end-of-year clearance has everything 30% off. You can get an extra 10% off if you buy 5 or more items. Student council members get another 5% off after other discounts.",
      "questions": [
        // Question 27.1
        {
          "question": "How much would a $20 backpack cost with just the clearance discount?",
          "options": ["$14", "$16", "$12", "$18", "Keep old backpack!"],
          "answer": "$14"
        },
        // Question 27.2
        {
          "question": "If you buy 5 items that each cost $10, what's the price after both regular discounts?",
          "options": ["$31.50", "$35.00", "$28.00", "$33.00", "Too many numbers!"],
          "answer": "$31.50"
        },
        // Question 27.3
        {
          "question": "How much extra would a student council member save on the 5 items?",
          "options": ["$1.58", "$2.00", "$1.25", "$1.75", "Skip the math!"],
          "answer": "$1.58"
        },
        // Question 27.4
        {
          "question": "What's the final cost for a student council member buying 5 $10 items?",
          "options": ["$29.92", "$31.00", "$28.75", "$32.50", "Just use old stuff!"],
          "answer": "$29.92"
        },
        // Question 27.5
        {
          "question": "What's the total percentage saved using all discounts?",
          "options": ["40.15%", "38%", "42%", "35%", "Percentages again!"],
          "answer": "40.15%"
        }
      ]
    },
    // Stage 28
    {
      "text": "The movie theater offers popcorn in three sizes: Small ($4), Medium ($6), or Large ($8). Refills are $2 for small, $3 for medium, and free for large. Sarah and two friends plan to get two refills each.",
      "questions": [
        // Question 28.1
        {
          "question": "How much would three small popcorns plus 6 refills cost?",
          "options": ["$24", "$22", "$26", "$20", "Bring snacks!"],
          "answer": "$24"
        },
        // Question 28.2
        {
          "question": "How much would three medium popcorns plus 6 refills cost?",
          "options": ["$36", "$33", "$39", "$30", "Too expensive!"],
          "answer": "$36"
        },
        // Question 28.3
        {
          "question": "How much would three large popcorns with free refills cost?",
          "options": ["$24", "$28", "$20", "$32", "Skip popcorn!"],
          "answer": "$24"
        },
        // Question 28.4
        {
          "question": "Which size is the best deal if they want two refills each?",
          "options": ["Large", "Medium", "Small", "All same", "Math overload!"],
          "answer": "Large"
        },
        // Question 28.5
        {
          "question": "How much would they save by choosing the best option?",
          "options": ["$12", "$10", "$14", "$8", "Too much math!"],
          "answer": "$12"
        }
      ]
    },
    // Stage 29
    {
      "text": "A sports store sells basketballs for $20 each. There's a team discount of 25% when buying 5 or more. The school basketball team needs 8 balls, and they have a $20 gift card.",
      "questions": [
        // Question 29.1
        {
          "question": "What's the regular cost for 8 basketballs?",
          "options": ["$160", "$150", "$170", "$140", "Use old balls!"],
          "answer": "$160"
        },
        // Question 29.2
        {
          "question": "How much is the team discount on 8 balls?",
          "options": ["$40", "$35", "$45", "$30", "Skip the discount!"],
          "answer": "$40"
        },
        // Question 29.3
        {
          "question": "What's the cost after the team discount?",
          "options": ["$120", "$110", "$130", "$125", "Too many numbers!"],
          "answer": "$120"
        },
        // Question 29.4
        {
          "question": "What's the final cost after using the gift card?",
          "options": ["$100", "$95", "$105", "$90", "Need a calculator!"],
          "answer": "$100"
        },
        // Question 29.5
        {
          "question": "What's the final price per basketball?",
          "options": ["$12.50", "$13.00", "$12.00", "$13.50", "Math hurts!"],
          "answer": "$12.50"
        }
      ]
    },
    // Stage 30
    {
      "text": "The school carnival sells ticket books: 10 tickets for $8, 25 tickets for $15, or 60 tickets for $30. Most games cost 3 tickets, some cost 4 tickets, and special games cost 6 tickets.",
      "questions": [
        // Question 30.1
        {
          "question": "Which ticket book has the best price per ticket?",
          "options": ["60 tickets", "25 tickets", "10 tickets", "All same", "Skip carnival!"],
          "answer": "60 tickets"
        },
        // Question 30.2
        {
          "question": "How many 3-ticket games can you play with 25 tickets?",
          "options": ["8", "7", "9", "6", "Too much counting!"],
          "answer": "8"
        },
        // Question 30.3
        {
          "question": "If you want to play 5 regular games (3 tickets) and 3 special games (6 tickets), how many tickets do you need?",
          "options": ["33", "30", "36", "27", "Math overload!"],
          "answer": "33"
        },
        // Question 30.4
        {
          "question": "What's the cheapest way to buy at least 33 tickets?",
          "options": ["25 + 10 tickets", "60 tickets", "10 + 10 + 10", "Three 10s", "Just go home!"],
          "answer": "25 + 10 tickets"
        },
        // Question 30.5
        {
          "question": "How much would this combination cost?",
          "options": ["$23", "$25", "$21", "$27", "Save your money!"],
          "answer": "$23"
        }
      ]
    }


				  ]
				}
        ];

		const stageCount = quizData[0].stages.length; // This is the correct way to get the number of stages


		const stateContents = {
			'Practice': `<div id="stage-number" class="stage-number">Stage 1 of ${stageCount}</div><div class="progress-bar-container"><div id="progress-bar" class="progress-bar"></div></div><div id="attempts">Attempts: 0</div><div id="quiz-content"></div><button class="center-button" onclick="checkStage()">Check Answers</button>`
			,'Subject Overview 🗝️': `<div class="subject-overview-content">     <h1>Multi-Step Money Problems: Understanding Discounts, Taxes, and Savings</h1>     <p>Multi-step money problems involve calculations that require several steps to solve, typically incorporating elements such as discounts, taxes, and savings. These problems are essential for managing personal finances, shopping smartly, and making informed financial decisions. This guide will explore the intricacies of multi-step money problems, providing clear explanations and practical examples to help you master these essential skills.</p>     <hr>     <h2>Table of Contents</h2>     <ol>         <li><a href="#what-are-multi-step-money-problems">What Are Multi-Step Money Problems?</a></li>         <li><a href="#key-components">Key Components of Multi-Step Money Problems</a></li>         <li><a href="#solving-multi-step-money-problems">Solving Multi-Step Money Problems</a>             <ul>                 <li><a href="#discounts">Discounts</a></li>                 <li><a href="#taxes">Taxes</a></li>                 <li><a href="#savings">Savings</a></li>             </ul>         </li>         <li><a href="#conclusion">Conclusion</a></li>     </ol>     <hr>     <h2 id="what-are-multi-step-money-problems">What Are Multi-Step Money Problems?</h2>     <p>Multi-step money problems are mathematical problems that require multiple calculations to find the solution. These problems often involve a combination of different financial concepts such as calculating discounts, adding taxes, and determining savings. They are common in everyday scenarios like shopping, budgeting, and financial planning.</p>     <p>Understanding how to approach and solve multi-step money problems is crucial for:</p>     <ul>         <li>Managing personal finances effectively.</li>         <li>Making informed purchasing decisions.</li>         <li>Planning for future savings and investments.</li>     </ul>     <hr>     <h2 id="key-components">Key Components of Multi-Step Money Problems</h2>     <p>To solve multi-step money problems, it's important to understand the key components involved:</p>     <ol>         <li><strong>Discounts</strong>: Reductions applied to the original price of an item or service.</li>         <li><strong>Taxes</strong>: Additional costs added to the price, usually as a percentage.</li>         <li><strong>Savings</strong>: Amounts set aside to reduce overall expenses or invest for future use.</li>     </ol>     <hr>     <h2 id="solving-multi-step-money-problems">Solving Multi-Step Money Problems</h2>     <h3 id="discounts">Discounts</h3>     <p><strong>Understanding Discounts:</strong></p>     <ol>         <li><strong>Percentage Discounts</strong>: A percentage reduction from the original price.<ul>             <li><em>Example:</em> A jacket originally priced at $80 is on sale for 25% off.</li>         </ul></li>         <li><strong>Fixed Amount Discounts</strong>: A specific dollar amount is subtracted from the original price.<ul>             <li><em>Example:</em> A store offers a $10 discount on purchases over $50.</li>         </ul></li>     </ol>     <p><strong>Calculating Discounts:</strong></p>     <ul>         <li>Percentage Discount Formula: <em>Discount Amount = Original Price × Discount Percentage</em></li>         <li>Fixed Amount Discount: Simply subtract the discount from the original price.</li>     </ul>     <p><strong>Examples:</strong></p>     <ul>         <li><em>If a pair of shoes costs $60 and there is a 20% discount, the discount amount is $60 × 0.20 = $12. The sale price is $60 - $12 = $48.</em></li>         <li><em>A customer buys a laptop for $500 with a $50 discount. The final price is $500 - $50 = $450.</em></li>     </ul>     <hr>     <h3 id="taxes">Taxes</h3>     <p><strong>Understanding Taxes:</strong></p>     <ol>         <li><strong>Sales Tax</strong>: A percentage added to the sale price of goods and services.<ul>             <li><em>Example:</em> A 7% sales tax on a $100 purchase adds $7, making the total $107.</li>         </ul></li>         <li><strong>Income Tax</strong>: Taxes imposed on earnings, often progressive based on income levels.</ul>     </ol>     <p><strong>Calculating Taxes:</strong></p>     <ul>         <li>Sales Tax Formula: <em>Total Price = Original Price + (Original Price × Tax Rate)</em></li>     </ul>     <p><strong>Examples:</strong></p>     <ul>         <li><em>If a book costs $15 with an 8% sales tax, the tax is $15 × 0.08 = $1.20. The total cost is $15 + $1.20 = $16.20.</em></li>         <li><em>A service costing $200 with a 5% tax adds $10, making the total $210.</em></li>     </ul>     <hr>     <h3 id="savings">Savings</h3>     <p><strong>Understanding Savings:</strong></p>     <ol>         <li><strong>Simple Savings</strong>: Money set aside without interest.<ul>             <li><em>Example:</em> Saving $100 from each paycheck.</li>         </ul></li>         <li><strong>Interest-Bearing Savings</strong>: Savings that earn interest over time.<ul>             <li><em>Example:</em> A savings account with a 2% annual interest rate.</li>         </ul></li>     </ol>     <p><strong>Calculating Savings:</strong></p>     <ul>         <li>Simple Savings: <em>Total Savings = Amount Saved × Number of Periods</em></li>         <li>Interest-Bearing Savings: <em>Total Savings = Principal × (1 + Interest Rate)^Number of Periods</em></li>     </ul>     <p><strong>Examples:</strong></p>     <ul>         <li><em>If you save $50 each month for 6 months, your total savings will be $50 × 6 = $300.</em></li>         <li><em>Saving $1,000 in an account with 3% annual interest for 2 years: $1,000 × (1 + 0.03)^2 ≈ $1,060.90.</em></li>     </ul>     <hr>     <h2 id="conclusion">Conclusion</h2>     <p>Mastering multi-step money problems is essential for effective financial management. By understanding how to calculate discounts, taxes, and savings, you can make informed decisions that maximize your financial well-being. Here&#39;s a quick recap:</p>     <ul>         <li><strong>Discounts</strong>: Calculate the reduced price by applying percentage or fixed amount discounts.</li>         <li><strong>Taxes</strong>: Add the appropriate tax rate to determine the total cost of purchases.</li>         <li><strong>Savings</strong>: Accumulate funds through regular saving practices, considering both simple and interest-bearing methods.</li>     </ul>     <p><strong>Remember</strong>: Practicing these calculations will enhance your ability to handle real-life financial scenarios with confidence and accuracy.</p>     <hr>     <p>By familiarizing yourself with multi-step money problems and their components, you&#39;ll be better equipped to navigate financial decisions, ensuring that you can save effectively, avoid unnecessary expenses, and understand the true cost of your purchases. Keep practicing these skills to build a strong foundation for your financial future!</p> </div>`		
			};


        function setQuizExpansion(allow) {
            allowQuizExpansion = allow;
            adjustLayout();
        }

        function adjustLayout() {
            const wrapper = document.querySelector('.content-wrapper');
            const quizContainer = document.getElementById('quizContainer');
            const sidePanel1 = document.getElementById('sidePanel1');
            
            const isPanel1Visible = window.getComputedStyle(sidePanel1).display !== 'none';

            wrapper.style.justifyContent = 'space-between';

            if (isPanel1Visible) {
                sidePanel1.style.flex = '0 0 calc(20% - 0.5rem)';
                sidePanel1.style.maxWidth = 'calc(20% - 0.5rem)';
                quizContainer.style.flex = '1';
            } else {
                quizContainer.style.flex = '1';
                wrapper.style.justifyContent = 'center';
            }

            [sidePanel1, quizContainer].forEach(el => {
                el.style.display = 'block';
            });
        }

        function togglePanel(panelId) {
            const panel = document.getElementById(panelId);
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
            adjustLayout();
        }

        function updateSwitcherLayout() {
            const switchElement = document.getElementById('multiStateSwitch');
            const labels = switchElement.querySelectorAll('.switch-label');
            const handle = switchElement.querySelector('.switch-handle');

            labels.forEach(label => {
                label.style.flex = 'none';
                label.style.padding = '0 20px';
            });

            const activeLabel = switchElement.querySelector('.switch-label.active');
            if (activeLabel) {
                const switchRect = switchElement.getBoundingClientRect();
                const labelRect = activeLabel.getBoundingClientRect();

                handle.style.left = `${labelRect.left - switchRect.left}px`;
                handle.style.width = `${labelRect.width}px`;
            }

            switchElement.style.width = 'auto';
        }
        
        function switchTab(index) {
            const switchElement = document.getElementById('multiStateSwitch');
            const labels = switchElement.querySelectorAll('.switch-label');
            const activeStates = Array.from(labels).map(label => label.textContent);

            labels.forEach((label, i) => {
                label.classList.toggle('active', i === index);
            });

            updateSwitcherLayout();
            showContent(activeStates[index]);

            adjustLayout();
        }

        function showContent(state) {
            const tabContent = document.getElementById('tabContent');
            tabContent.innerHTML = stateContents[state] || '';

            if (state === 'Practice') {
                renderQuiz();
                updateProgressBar();
            }
        }

function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

function isTextEmpty(text) {
    return !text || text.trim() === "";
}

function renderQuiz() {
    const quizContainer = document.getElementById("quiz-content");
    quizContainer.innerHTML = '';
    
    // Only add stage text if it's not empty
    const stageText = quizData[0].stages[currentStage].text;
    if (!isTextEmpty(stageText)) {
        const stageTextElement = document.createElement("div");
        stageTextElement.className = "stage-text";
        stageTextElement.style.marginBottom = "20px";
        stageTextElement.style.padding = "15px";
        stageTextElement.style.backgroundColor = "#f5f5f5";
        stageTextElement.style.borderRadius = "5px";
        stageTextElement.textContent = stageText;
        quizContainer.appendChild(stageTextElement);
    }
    
    // Render questions
    quizData[0].stages[currentStage].questions.forEach((questionData, index) => {
        const questionElement = document.createElement("div");
        questionElement.className = "question-one-line";
        
        const label = document.createElement("label");
        label.htmlFor = `q${index}`;
        label.textContent = `${index + 1}. ${questionData.question}`;
        
        const resultDiv = document.createElement("div");
        resultDiv.className = "result result-ltr";
        resultDiv.id = `result${index}`;
        
        const select = document.createElement("select");
        select.id = `q${index}`;
        select.name = `q${index}`;
        
        const defaultOption = document.createElement("option");
        defaultOption.value = "";
        defaultOption.textContent = "Select";
        select.appendChild(defaultOption);
        
        const shuffledOptions = shuffleArray([...questionData.options]);
        shuffledOptions.forEach(option => {
            const optionElement = document.createElement("option");
            optionElement.value = option;
            optionElement.textContent = option;
            select.appendChild(optionElement);
        });
        
        questionElement.appendChild(label);
        questionElement.appendChild(resultDiv);
        questionElement.appendChild(select);
        
        quizContainer.appendChild(questionElement);
    });

    updateStageNumber();
}

function checkStage() {
    attempts++;
    document.getElementById("attempts").textContent = `Attempts: ${attempts}`;

    let correctCount = 0;
    const totalQuestions = quizData[0].stages[currentStage].questions.length;

    quizData[0].stages[currentStage].questions.forEach((questionData, index) => {
        const resultElement = document.getElementById(`result${index}`);
        const selectElement = document.getElementById(`q${index}`);
        const selectedAnswer = selectElement.value;

        if (selectedAnswer === questionData.answer) {
            resultElement.textContent = "Correct!";
            resultElement.style.color = "green";
            correctCount++;
        } else {
            resultElement.textContent = "Incorrect answer.";
            resultElement.style.color = "red";
        }

        if (attempts >= 10) {
            selectElement.value = questionData.answer;
            selectElement.disabled = true;
            resultElement.textContent += ` The correct answer is: ${questionData.answer}`;
        }
    });

    if (correctCount === totalQuestions) {
        console.log(`Stage ${currentStage + 1}: ${correctCount} correct out of ${totalQuestions}`);
        addAnimalsToFarm(totalQuestions);

        if (currentStage < quizData[0].stages.length - 1) {
            singleStageConfetti();
            showEncouragingPopup(correctCount, totalQuestions, true);
            currentStage++;
            updateProgressBar();
            setTimeout(() => {
                attempts = 0;
                renderQuiz();
                document.getElementById("attempts").textContent = `Attempts: ${attempts}`;
            }, 1500);
        } else {
            currentStage++;
            updateProgressBar();
            allStagesConfetti();
            showModal("Congratulations! You've completed all stages!");
        }
    } else {
        showEncouragingPopup(correctCount, totalQuestions, false);
        if (attempts >= 10) {
            showModal("You've reached the maximum number of attempts. The correct answers have been revealed.");
        }
    }

    scrollToTop();
}

// 4. Update stageCount calculation to work with new structure

		
		function showEncouragingPopup(correctCount, totalQuestions, isStageComplete) {
			const incorrectCount = totalQuestions - correctCount;
			let message = `You got ${correctCount} correct and ${incorrectCount} incorrect.`;
			
			// Add encouraging message based on performance
			if (correctCount === totalQuestions) {
				message += " Perfect score!";
			} else if (correctCount >= Math.ceil(totalQuestions * 0.7)) {
				message += " Great job! You're really getting the hang of this!";
			} else if (correctCount >= Math.ceil(totalQuestions * 0.5)) {
				message += " Good effort! Keep practicing and you'll improve in no time!";
			} else {
				message += " Don't give up! Every attempt helps you learn. Try again!";
			}

			// Add stage completion message if applicable
			if (isStageComplete) {
				message += "\n\n You've completed this stage. Moving to the next stage.";
			}

			showModal(message);
		}

		function initializeQuiz() {
			currentStage = 0;
			attempts = 0;
			updateProgressBar(); // This should now set the progress to 0%
			renderQuiz();
			document.getElementById("attempts").textContent = `Attempts: ${attempts}`;
			updateStageNumber();
		}

function updateProgressBar() {
    const progressBar = document.getElementById("progress-bar");
    const completedStages = currentStage;
    const progress = (completedStages / stageCount) * 100;
    const roundedProgress = Math.min(100, Math.max(0, Math.round(progress)));
    progressBar.style.width = `${roundedProgress}%`;
    progressBar.textContent = roundedProgress > 0 ? `${roundedProgress}%` : '';
    console.log(`Progress updated: ${roundedProgress}% (Stage ${currentStage + 1} of ${stageCount})`);
}

function updateStageNumber() {
    const stageElement = document.getElementById("stage-number");
    stageElement.textContent = `Stage ${currentStage + 1} of ${stageCount}`;
}

		function singleStageConfetti() {
			function randomInRange(min, max) {
				return Math.random() * (max - min) + min;
			}
			confetti({
				angle: randomInRange(55, 125),
				spread: randomInRange(50, 70),
				particleCount: randomInRange(50, 100),
				origin: { y: 0.6 },
			});
		}

		function allStagesConfetti() {
			const defaults = {
				spread: 360,
				ticks: 50,
				gravity: 0,
				decay: 0.94,
				startVelocity: 30,
				shapes: ["star"],
				colors: ["FFE400", "FFBD00", "E89400", "FFCA6C", "FDFFB8"],
			};
			function shoot() {
				confetti({
					...defaults,
					particleCount: 40,
					scalar: 1.2,
					shapes: ["star"],
				});
				confetti({
					...defaults,
					particleCount: 10,
					scalar: 0.75,
					shapes: ["circle"],
				});
			}
			setTimeout(shoot, 0);
			setTimeout(shoot, 100);
			setTimeout(shoot, 200);
		}

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
			    scrollToTopBtn.style.display = "none";
        }

        function initializeSwitch() {
            const switchElement = document.getElementById('multiStateSwitch');
            const labelsContainer = switchElement.querySelector('.switch-labels');
            const switchContainer = document.getElementById('switchContainer');
            
            const activeStates = Object.keys(stateContents).filter(state => stateContents[state].trim() !== '');
            
            if (activeStates.length <= 1) {
                switchContainer.style.display = 'none';
                if (activeStates.length === 1) {
                    showContent(activeStates[0]);
                }
                return;
            }
            
            switchContainer.style.display = 'flex';
            
            activeStates.forEach((state, index) => {
                const label = document.createElement('div');
                label.className = 'switch-label';
                label.textContent = state;
                label.addEventListener('click', () => switchTab(index));
                labelsContainer.appendChild(label);
            });
   
            const defaultTab = manuallySetDefaultTab !== null && manuallySetDefaultTab < activeStates.length
                ? manuallySetDefaultTab
                : 0;

            switchTab(defaultTab);
        }

		let farmAnimals = [];

		function addAnimalsToFarm(count) {
			const animalFarm = document.getElementById('animalFarm');
			let availableAnimals = animals.filter(animal => !farmAnimals.includes(animal));

			console.log(`Adding ${count} animals to the farm. Current farm size: ${farmAnimals.length}`);

			for (let i = 0; i < count; i++) {
				if (availableAnimals.length === 0) {
					console.log("No more unique animals available!");
					break;
				}

				const randomIndex = Math.floor(Math.random() * availableAnimals.length);
				const chosenAnimal = availableAnimals[randomIndex];

				const animalElement = document.createElement('li');
				animalElement.textContent = chosenAnimal;
				animalFarm.appendChild(animalElement);

				farmAnimals.push(chosenAnimal);
				availableAnimals.splice(randomIndex, 1);
				console.log(`Added animal: ${chosenAnimal}`);
			}

			console.log(`Farm size after addition: ${farmAnimals.length}`);
			logAnimalFarmState();
		}

		function logAnimalFarmState() {
			console.log(`Current animal farm state: ${farmAnimals.length} animals`);
			console.log(farmAnimals);
		}

		const animals = [
			"🐉", "🐻", "🦗", "🦁", "🐔", "🦂", "🐟", "🐣", "🐯", "🦡",
			"🐰", "🐍", "🦅", "🐈", "🦈", "🦜", "🦛", "🐀", "🐑",
			"🐮", "🦇", "🐇", "🦖", "🦀", "🦎", "🐃", "🐡", "🐤",
			"🐪", "🦥", "🐛", "🐅", "🐥", "🐱", "🐺", "🐕", "🦩", "🐊",
			"🐖", "🐢", "🕷", "🦕", "🦌", "🐁", "🦨", "🦘", "🐵",
			"🦑", "🐋", "🦓", "🦒", "🐲", "🦆", "🦉", "🐶", "🐄", "🦟",
			"🦃", "🦧", "🦏", "🐙", "🐿", "🦢", "🐜", "🐦", "🐞",
			"🦐", "🦔", "🐼", "🦄", "🦞", "🐫", "🐭", "🐆", "🦝",
			"🐠", "🦚", "🐴", "🐏", "🦮", "🐐", "🐹", "🐎", "🦋", "🐳",
			"🐨", "🐂", "🦍", "🦙", "🐬", "🦦", "🦊", "🐌", "🐓", "🐧",
			"🐷", "🐩", "🐘", "🐸", "🐝"
		];

        function showModal(message) {
            const modal = document.getElementById("quizModal");
            const modalMessage = document.getElementById("modalMessage");
            const modalButton = document.getElementById("modalButton");
            const modalClose = document.getElementsByClassName("modal-quiz-close")[0];

            modalMessage.textContent = message;
            modal.style.display = "block";

            modalButton.onclick = function() {
                modal.style.display = "none";
            }

            modalClose.onclick = function() {
                modal.style.display = "none";
            }

            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }
        }

		window.addEventListener('load', () => {
			initializeSwitch();
			initializeQuiz();
			adjustLayout();
        });

        window.addEventListener('resize', adjustLayout);

        // Load the copyright content from the external URL and insert it into the div
        fetch('http://ez42.live/global/copyright.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('copyright-container').innerHTML = data;
            })
            .catch(error => console.error('Error loading copyright:', error));
			
		let scrollToTopBtn = document.getElementById("scrollToTopBtn");

			window.onscroll = function() {
				// Check if the scroll distance is more than twice the height of the screen
				if (document.body.scrollTop > window.innerHeight * 1.5 || 
					document.documentElement.scrollTop > window.innerHeight * 1.5) {
					scrollToTopBtn.style.display = "block";
				} else {
					scrollToTopBtn.style.display = "none";
				}
			};

		scrollToTopBtn.onclick = function() {
		  document.body.scrollTop = 0;
		  document.documentElement.scrollTop = 0;
		};	
    </script>
</body>
</html>